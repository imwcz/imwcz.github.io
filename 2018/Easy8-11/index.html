<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="简单题汇总,动态规划,倍增,状压dp,记忆化搜索,Tarjan,斜率优化,01Trie,RMQ,点分治," />









<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

<meta name="description" content="P2757 [国家集训队]等差子序列Description给一个1到N的排列{Ai}，询问是否存在$$1\le p_1&amp;lt;p_2&amp;lt; p_3&amp;lt;p_4 &amp;lt;p_5&amp;lt;\cdots&amp;lt;p_{Len}\le N(Len\ge 3)$$使得 $Ap_1,Ap_2,Ap_3,\cdots,Ap_{Len}$ 是一个等差序列。
Solution$n^2$暴力脸好可过.
Code12">
<meta property="og:type" content="article">
<meta property="og:title" content="八月第二三周简单题汇总">
<meta property="og:url" content="http://aiyoupass.com/2018/Easy8-11/index.html">
<meta property="og:site_name" content="落花微雨">
<meta property="og:description" content="P2757 [国家集训队]等差子序列Description给一个1到N的排列{Ai}，询问是否存在$$1\le p_1&amp;lt;p_2&amp;lt; p_3&amp;lt;p_4 &amp;lt;p_5&amp;lt;\cdots&amp;lt;p_{Len}\le N(Len\ge 3)$$使得 $Ap_1,Ap_2,Ap_3,\cdots,Ap_{Len}$ 是一个等差序列。
Solution$n^2$暴力脸好可过.
Code12">
<meta property="og:image" content="https://i.loli.net/2018/08/11/5b6e5a01eecdd.png">
<meta property="og:image" content="https://i.loli.net/2018/08/11/5b6e8ed15b0ae.jpeg">
<meta property="og:image" content="https://i.loli.net/2018/08/11/5b6e8be48d905.png">
<meta property="og:image" content="https://i.loli.net/2018/08/19/5b78b99caa460.png">
<meta property="og:updated_time" content="2018-08-22T13:38:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="八月第二三周简单题汇总">
<meta name="twitter:description" content="P2757 [国家集训队]等差子序列Description给一个1到N的排列{Ai}，询问是否存在$$1\le p_1&amp;lt;p_2&amp;lt; p_3&amp;lt;p_4 &amp;lt;p_5&amp;lt;\cdots&amp;lt;p_{Len}\le N(Len\ge 3)$$使得 $Ap_1,Ap_2,Ap_3,\cdots,Ap_{Len}$ 是一个等差序列。
Solution$n^2$暴力脸好可过.
Code12">
<meta name="twitter:image" content="https://i.loli.net/2018/08/11/5b6e5a01eecdd.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '9AZWK32GMU',
      apiKey: 'cfdae09f7596feb4221d4e18c22a727a',
      indexName: 'blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://aiyoupass.com/2018/Easy8-11/"/>





  <title>八月第二三周简单题汇总 | 落花微雨</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">落花微雨</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">用笑容去改变世界,别让世界改变了你的笑容.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            Schedule
          </a>
        </li>
      
        
        <li class="menu-item menu-item-knowledge">
          <a href="/Knowledge/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bookmark"></i> <br />
            
            Knowledge
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/Easy8-11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">八月第二三周简单题汇总</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-11T11:50:00+08:00">
                2018-08-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/题目/" itemprop="url" rel="index">
                    <span itemprop="name">题目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/Easy8-11/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/Easy8-11/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <a id="more"></a>
<h2 id="P2757-国家集训队-等差子序列"><a href="#P2757-国家集训队-等差子序列" class="headerlink" title="P2757 [国家集训队]等差子序列"></a>P2757 [国家集训队]等差子序列</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>给一个1到N的排列{Ai}，询问是否存在<br>$$1\le p_1&lt;p_2&lt; p_3&lt;p_4 &lt;p_5&lt;\cdots&lt;p_{Len}\le N(Len\ge 3)$$<br>使得 $Ap_1,Ap_2,Ap_3,\cdots,Ap_{Len}$ 是一个等差序列。</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>$n^2$暴力脸好可过.</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctype.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;s)</span> </span>&#123;</div><div class="line">    <span class="keyword">register</span> <span class="keyword">char</span> ch = getchar(); s = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = getchar());</div><div class="line">    <span class="keyword">for</span> (; <span class="built_in">isdigit</span>(ch); s = s * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar());</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10007</span>; </div><div class="line"><span class="keyword">int</span> a[N],b[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">int</span> n, t;</div><div class="line">    read(t);</div><div class="line">    <span class="keyword">while</span>(t --) &#123;</div><div class="line">        read(n); <span class="keyword">bool</span> flag = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>) read(a[i]),b[a[i]] = i; </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>) &#123; </div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;++ j) &#123; </div><div class="line">                <span class="keyword">int</span> k = a[i];</div><div class="line">                <span class="keyword">if</span>(k + j + j &lt;= n) </div><div class="line">                    <span class="keyword">if</span>(b[k + j] &gt; i &amp;&amp; b[k + j + j] &gt; b[k + j]) &#123;flag = <span class="literal">true</span>;<span class="keyword">break</span>;&#125; </div><div class="line">                <span class="keyword">if</span>(k - j - j &gt; <span class="number">0</span>)  </div><div class="line">                    <span class="keyword">if</span>(b[k - j] &gt; i &amp;&amp; b[k - j - j] &gt; b[k - j]) &#123;flag = <span class="literal">true</span>;<span class="keyword">break</span>;&#125; </div><div class="line">            &#125; </div><div class="line">            <span class="keyword">if</span>(flag) <span class="keyword">break</span>; </div><div class="line">        &#125; </div><div class="line">        <span class="keyword">if</span>(flag) <span class="built_in">puts</span>(<span class="string">"Y"</span>); </div><div class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"N"</span>); </div><div class="line">        <span class="built_in">memset</span>(b, <span class="literal">false</span>, <span class="keyword">sizeof</span> b);</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P4341-BJWC2010-外星联络"><a href="#P4341-BJWC2010-外星联络" class="headerlink" title="P4341 [BJWC2010]外星联络"></a>P4341 [BJWC2010]外星联络</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>小 P 在看过电影《超时空接触》(Contact)之后被深深的打动，决心致力于寻找外星人的事业。于是，他每天晚上都爬在屋顶上试图用自己的收音机收听外星人发来的信息。</p>
<p>虽然他收听到的仅仅是一些噪声，但是他还是按照这些噪声的高低电平将接收到的信号改写为由 0 和 1 构成的串， 并坚信外星人的信息就隐藏在其中。他认为，外星人发来的信息一定会在他接受到的 01 串中重复出现，所以他希望找到他接受到的 01 串中所有重复出现次数大于 111 的子串。</p>
<p>但是他收到的信号串实在是太长了，于是，他希望你能编一个程序来帮助他。</p>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><p>需要求出每个子串出现的次数, 可以用后缀数组直接解决.我的解法是Trie树, 反正$N^2$复杂度很够.</p>
<p>对于luogu的评测我真的无能为力, <del>BZOJ大法好</del><br><img src="https://i.loli.net/2018/08/11/5b6e5a01eecdd.png" alt=""><br><del>每次在luogu有问题发讨论就像石沉大海</del><br>好像Luogu评测机编译目标平台是X64, 因此是64位的指针, 两倍空间……(真坑).</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><h4 id="Code1"><a href="#Code1" class="headerlink" title="Code1"></a>Code1</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">string</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">cin</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">    <span class="keyword">int</span> cnt;</div><div class="line">    Node *ch[<span class="number">2</span>];</div><div class="line">    Node () &#123; ch[<span class="number">0</span>] = ch[<span class="number">1</span>] = <span class="literal">NULL</span>; cnt = <span class="number">0</span>; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span> <span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (cnt &gt; <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, cnt);</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">0</span>]) ch[<span class="number">0</span>]-&gt;dfs();</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">1</span>]) ch[<span class="number">1</span>]-&gt;dfs();</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">class</span> Trie &#123;</div><div class="line">    Node* root;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Trie() &#123; root = <span class="keyword">new</span> Node (); &#125; </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> </span>&#123; root-&gt;dfs(); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">InsertAll</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; str)</span> </span>&#123;</div><div class="line">        Node* node = root;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.size(); i += <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">bool</span> d = str[i] - <span class="string">'0'</span>;</div><div class="line">            <span class="keyword">if</span> (!node-&gt;ch[d]) node-&gt;ch[d] = <span class="keyword">new</span> Node();</div><div class="line">            node = node-&gt;ch[d];</div><div class="line">            node-&gt;cnt += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n;<span class="built_in">string</span> str;</div><div class="line">    Trie* T = <span class="keyword">new</span> Trie();</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; str;</div><div class="line">    <span class="keyword">int</span> Len = str.size();</div><div class="line">    <span class="built_in">string</span> s; </div><div class="line">    n = <span class="built_in">std</span>:: min(n, Len);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>)&#123;</div><div class="line">        s = str.substr(i, n - i);</div><div class="line">        T-&gt;InsertAll(s);</div><div class="line">    &#125;</div><div class="line">    T-&gt;Show();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Code2"><a href="#Code2" class="headerlink" title="Code2"></a>Code2</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">string</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">cin</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">9000005</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">    <span class="keyword">int</span> cnt;</div><div class="line">    Node *ch[<span class="number">2</span>];</div><div class="line">    Node () &#123; ch[<span class="number">0</span>] = ch[<span class="number">1</span>] = <span class="literal">NULL</span>; cnt = <span class="number">0</span>; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span> <span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (cnt &gt; <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, cnt);</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">0</span>]) ch[<span class="number">0</span>]-&gt;dfs();</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">1</span>]) ch[<span class="number">1</span>]-&gt;dfs();</div><div class="line">    &#125;</div><div class="line">&#125;pool[N];</div><div class="line"></div><div class="line"><span class="function">Node* <span class="title">new_Node</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> &amp;pool[cnt++];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">class</span> Trie &#123;</div><div class="line">    Node* root;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Trie() &#123; root = new_Node (); &#125; </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> </span>&#123; root-&gt;dfs(); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">InsertAll</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; str)</span> </span>&#123;</div><div class="line">        Node* node = root;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.size(); i += <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">bool</span> d = str[i] - <span class="string">'0'</span>;</div><div class="line">            <span class="keyword">if</span> (!node-&gt;ch[d]) node-&gt;ch[d] = new_Node();</div><div class="line">            node = node-&gt;ch[d];</div><div class="line">            node-&gt;cnt += <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n;<span class="built_in">string</span> str;</div><div class="line">    Trie* T = <span class="keyword">new</span> Trie();</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; str;</div><div class="line">    <span class="keyword">int</span> Len = str.size();</div><div class="line">    <span class="built_in">string</span> s; </div><div class="line">    n = <span class="built_in">std</span>:: min(n, Len);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>)&#123;</div><div class="line">        s = str.substr(i, n - i);</div><div class="line">        T-&gt;InsertAll(s);</div><div class="line">    &#125;</div><div class="line">    T-&gt;Show();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P2251-质量检测"><a href="#P2251-质量检测" class="headerlink" title="P2251 质量检测"></a>P2251 质量检测</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>为了检测生产流水线上总共N件产品的质量，我们首先给每一件产品打一个分数A表示其品质，然后统计前M件产品中质量最差的产品的分值Q[m] = min{A1, A2, … Am}，以及第2至第M + 1件的Q[m + 1], Q[m + 2] … 最后统计第N - M + 1至第N件的Q[n]。根据Q再做进一步评估。</p>
<p>请你尽快求出Q序列。</p>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><p>利用RMQ算法实现$O(\log_2 n)$预处理, $O(1)$查询.</p>
<h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000005</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: min;</div><div class="line"></div><div class="line"><span class="keyword">int</span> f[N][<span class="number">20</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f[i][<span class="number">0</span>]);</div><div class="line">    <span class="keyword">int</span> len = <span class="keyword">int</span>(log2(n)) + <span class="number">2</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i += <span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j += <span class="number">1</span>)</div><div class="line">            f[j][i] = min (f[j][i - <span class="number">1</span>], f[j + (<span class="number">1</span> &lt;&lt; i - <span class="number">1</span>)][i - <span class="number">1</span>]);</div><div class="line">    len = <span class="keyword">int</span>(log2(m));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + m - <span class="number">1</span> &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, min(f[i][len], f[i + m - (<span class="number">1</span> &lt;&lt; len)][len]));</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P3137-USACO16FEB-圆形谷仓Circular-Barn-Silver"><a href="#P3137-USACO16FEB-圆形谷仓Circular-Barn-Silver" class="headerlink" title="P3137 [USACO16FEB]圆形谷仓Circular Barn_Silver"></a>P3137 [USACO16FEB]圆形谷仓Circular Barn_Silver</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>给定一个环长为n的环上每个点上有aia_i只牛，每只牛可以在环上顺时针移动，代价为移动距离的平方，问将环上每个节点上都有一只牛的代价是多少?</p>
<h3 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h3><p>断链为环, 枚举一个不动点, 用优先队列选取最优值.</p>
<h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: min;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">vector</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: greater;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: priority_queue;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4005</span>, inf = <span class="number">0x3f3f3f3f</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> a[N];</div><div class="line">priority_queue&lt;<span class="keyword">int</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ,greater&lt;<span class="keyword">int</span>&gt; &gt;que;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, ans = inf;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ;i &lt;= n; i += <span class="number">1</span>) </div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, a + i),a[i + n] = a[i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">bool</span> flag = <span class="number">0</span>; <span class="keyword">int</span> tot = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt;= i + n - <span class="number">1</span>; j += <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">if</span>(que.empty() &amp;&amp; !a[j]) &#123;</div><div class="line">                flag=<span class="number">1</span>; <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> tmp = a[j];</div><div class="line">            <span class="keyword">while</span>(tmp--) que.push(j);</div><div class="line">            <span class="keyword">int</span> top = que.top(); que.pop();</div><div class="line">            tot += (j - top) * (j - top);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(flag) <span class="keyword">continue</span>;</div><div class="line">        ans=min(ans,tot);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P2921-USACO08DEC-在农场万圣节Trick-or-Treat-on-the-Farm"><a href="#P2921-USACO08DEC-在农场万圣节Trick-or-Treat-on-the-Farm" class="headerlink" title="P2921 [USACO08DEC]在农场万圣节Trick or Treat on the Farm"></a>P2921 [USACO08DEC]在农场万圣节Trick or Treat on the Farm</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>每年，在威斯康星州，奶牛们都会穿上衣服，收集农夫约翰在N(1&lt;=N&lt;=100，000)个牛棚隔间中留下的糖果，以此来庆祝美国秋天的万圣节。</p>
<p>由于牛棚不太大，FJ通过指定奶牛必须遵循的穿越路线来确保奶牛的乐趣。为了实现这个让奶牛在牛棚里来回穿梭的方案，FJ在第i号隔间上张贴了一个“下一个隔间”Next_i(1&lt;=Next_i&lt;=N)，告诉奶牛要去的下一个隔间；这样，为了收集它们的糖果，奶牛就会在牛棚里来回穿梭了。</p>
<p>FJ命令奶牛i应该从i号隔间开始收集糖果。如果一只奶牛回到某一个她已经去过的隔间，她就会停止收集糖果。</p>
<p>在被迫停止收集糖果之前，计算一下每头奶牛要前往的隔间数（包含起点）。</p>
<h3 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution"></a>Solution</h3><p>利用Tarjan求出每个环的大小.<br>然后利用记忆化搜索求解.</p>
<h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: min;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100005</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> f[N], col[N], _;</div><div class="line"><span class="keyword">int</span> vis[N], que[N], h;</div><div class="line"><span class="keyword">int</span> dfn[N], low[N], siz[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span>&amp; tim)</span> </span>&#123;</div><div class="line">    dfn[x] = low[x] = ++tim, vis[x] = <span class="literal">true</span>;</div><div class="line">    que[h += <span class="number">1</span>] = x;</div><div class="line">    <span class="keyword">if</span> (!dfn[f[x]])</div><div class="line">        dfs(f[x], tim), low[x] = min(low[x], low[f[x]]);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(vis[f[x]]) low[x] = min(low[x], low[f[x]]);</div><div class="line">    <span class="keyword">if</span> (low[x] == dfn[x]) &#123;</div><div class="line">        col[x] = ++_, vis[x] = <span class="literal">false</span>, siz[_] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (que[h] != x)</div><div class="line">            col[que[h]] = _, vis[que[h --]] = <span class="literal">false</span>, siz[_] += <span class="number">1</span>;</div><div class="line">        h -= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> F[N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (F[x]) <span class="keyword">return</span> F[x];</div><div class="line">    <span class="keyword">if</span> (f[x] == x) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (siz[col[x]] &gt; <span class="number">1</span>) <span class="keyword">return</span> siz[col[x]];</div><div class="line">    <span class="keyword">return</span> F[x] = Find(f[x]) + <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f[i]);</div><div class="line">    <span class="keyword">int</span> tim = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="keyword">if</span> (!dfn[i])</div><div class="line">            dfs(i, tim);</div><div class="line">    <span class="keyword">int</span> pos, s;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Find(i));</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P1318-积水面积"><a href="#P1318-积水面积" class="headerlink" title="P1318 积水面积"></a>P1318 积水面积</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>一组正整数，分别表示由正方体迭起的柱子的高度。若某高度值为x，表示由x个正立方的方块迭起（如下图，0&lt;=x&lt;=5000）。找出所有可能积水的地方（图中蓝色部分），统计它们可能积水的面积总和（计算的是图中的横截面积。一个立方体的位置，为一个单位面积）。</p>
<p>如图：柱子高度变化为 0 1 0 2 1 2 0 0 2 0<br><img src="https://i.loli.net/2018/08/11/5b6e8ed15b0ae.jpeg" alt=""><br>图中蓝色部分为积水面积，共有6个单位面积积水。</p>
<h3 id="Solution-5"><a href="#Solution-5" class="headerlink" title="Solution"></a>Solution</h3><p>Interesting!</p>
<p>以前搞过一道二维的类似的题, 今天竟然遇到一维的啦!</p>
<p><img src="https://i.loli.net/2018/08/11/5b6e8be48d905.png" alt=""></p>
<p><strong>降维打击真是美滋滋</strong></p>
<p>下面的做法同时适用于二维的情况:</p>
<ul>
<li>首先把边界中的点入小根堆, 高度小的先弹出.</li>
<li>一个一个从堆中弹出点, 向上下左右扩展, 若高度低于它, 则更新它的高度; 高度高于它, 不管. 两种都入堆.</li>
<li>注意: 一个点只能被更新一次, 入堆一次.</li>
</ul>
<p>想一想, 这个做法为什么正确?<br>因为一个位置若存放了多余它能力的水, 必定会从某个边界位置流出, </p>
<p>我们做的就是它的一个类似的逆过程, 而使用小根堆就是为了保证一个点被增加到的高度, 恰好就是它能力的最大值.</p>
<p>想一想木桶效应, 就知道为什么要使用小根堆了.</p>
<h3 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: pair;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">vector</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: priority_queue;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10005</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">    <span class="keyword">int</span> p, h;</div><div class="line">    Node () &#123;&#125;</div><div class="line">    Node (<span class="keyword">int</span> P, <span class="keyword">int</span> H): p(P), h(H)&#123;&#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;o) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> h &gt; o.h;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> h[N];</div><div class="line"><span class="keyword">int</span> vis[N];</div><div class="line"></div><div class="line">priority_queue&lt;Node&gt; que;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, ans;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;h[i]);</div><div class="line">    que.push(Node(<span class="number">1</span>, h[<span class="number">1</span>])), </div><div class="line">    que.push(Node(n, h[n]));</div><div class="line">    vis[<span class="number">1</span>] = vis[n] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">        Node top = que.top(); que.pop();</div><div class="line">        <span class="keyword">if</span> (top.p &gt; <span class="number">1</span> &amp;&amp; !vis[top.p - <span class="number">1</span>]) &#123;</div><div class="line">            <span class="keyword">if</span>(top.h &gt; h[top.p - <span class="number">1</span>]) &#123;</div><div class="line">                ans += top.h - h[top.p - <span class="number">1</span>];</div><div class="line">                h[top.p - <span class="number">1</span>] = top.h;</div><div class="line">            &#125;</div><div class="line">            que.push(Node(top.p - <span class="number">1</span>, h[top.p - <span class="number">1</span>]));</div><div class="line">            vis[top.p - <span class="number">1</span>] = <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (top.p &lt; n &amp;&amp; !vis[top.p + <span class="number">1</span>])&#123;</div><div class="line">            <span class="keyword">if</span> (top.h &gt; h[top.p + <span class="number">1</span>]) &#123;</div><div class="line">                ans += top.h - h[top.p + <span class="number">1</span>];</div><div class="line">                h[top.p + <span class="number">1</span>] = top.h;</div><div class="line">            &#125;</div><div class="line">            que.push(Node(top.p + <span class="number">1</span>, h[top.p + <span class="number">1</span>]));</div><div class="line">            vis[top.p + <span class="number">1</span>] = <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P3994-高速公路"><a href="#P3994-高速公路" class="headerlink" title="P3994 高速公路"></a>P3994 高速公路</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><p>C国拥有一张四通八达的高速公路网树，其中有n个城市，城市之间由一共n-1条高速公路连接。除了首都1号城市，每个城市都有一家本地的客运公司，可以发车前往全国各地，有若干条高速公路连向其他城市，这是一个树型结构，1号城市（首都）为根。假设有一个人要从i号城市坐车出发前往j号城市，那么他要花费Pi*（i城市到j城市的距离）+Qi元。由于距离首都越远，国家的监管就越松，所以距离首都越远，客运公司的Pi（单位距离价格）越大，形式化的说，如果把高速路网看成一棵以首都为根的有根树，i号城市是j号城市的某个祖先，那么一定存在Pi&lt;=Pj。</p>
<h3 id="Solution-6"><a href="#Solution-6" class="headerlink" title="Solution"></a>Solution</h3><p>如果把树上的链单独拿出来考虑的话, 可以列出dp方程<br>$$<br>f_i = \min f_j+dis_j\cdot P_i +q_i<br>$$<br>可以考虑使用斜率优化, 当从$j$转移比$k$更优时满足<br>$$<br>f_j+dis_{i,j}\cdot P_i +q_i<f_k+dis_{i,k}\cdot p_i="" +q_i\\="" \rightarrow="">\frac{f_j-f_k}{dis_{i,k}-dis_{i,j}}<br>$$<br>考虑到这里我就没有办法了， 因为这需要维护一个单调队列, 而后效性使得每个拥有多个子节点的结点必须单独保存一个单调队列, 这需要大量的空间.</f_k+dis_{i,k}\cdot></p>
<p>无奈之下, 求助于XXY学姐的<a href="http://www.cnblogs.com/TheRoadToTheGold/p/8468557.html#commentform" target="_blank" rel="external">Blog</a>.</p>
<pre><code>只需要考虑如何去除兄弟节点的子树对单调队列的影响
即在一个节点退出dfs时，将单调队列恢复为这个节点开始dfs的情况
头指针只是不断的+1，没有涉及到单调队列中元素的修改，所以记录下头指针在哪个位置即可
尾指针涉及到元素的替换，但是它只会替换一个元素，所以记录下尾指针的位置，以及被当前点替换的元素是谁
当节点退出dfs时，恢复记录的这三个值即可
这样的话，一个节点多次出队入队，时间复杂度就不是O（n）了
所以二分出队位置，时间复杂度为O（nlogn）
</code></pre><p>发现这个后效性好像也没有那么的难处理, 只要仔细观察和分析就能发现它的性质.</p>
<h3 id="Code-6"><a href="#Code-6" class="headerlink" title="Code"></a>Code</h3><p>贴上我WA的代码(又挖一坑).<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000005</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: make_pair;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: pair;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge &#123;</div><div class="line">    <span class="keyword">int</span> v, c, nxt;</div><div class="line">&#125;e[N];</div><div class="line"><span class="keyword">int</span> head[N], tot;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">    e[++tot] = (Edge) &#123;v, c, head[u]&#125;; head[u] = tot;</div><div class="line">&#125;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dis[N], P[N], Q[N], f[N];</div><div class="line"><span class="keyword">int</span> q[N], h, t;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">Scope</span><span class="params">(<span class="keyword">int</span> j, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (f[j] - f[k]) / (dis[k] - dis[j]);</div><div class="line">&#125;</div><div class="line"></div><div class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; dfs(<span class="keyword">int</span> x) &#123;</div><div class="line">    dis[x] += dis[f[x]];</div><div class="line">    <span class="keyword">int</span> T, H, O, TT; pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; o;</div><div class="line">    <span class="keyword">if</span> (f[x] == <span class="number">1</span>) &#123;</div><div class="line">        f[x] = dis[x] * P[x] + Q[x];</div><div class="line">        q[t += <span class="number">1</span>] = x;</div><div class="line">        T = t, H = <span class="number">1</span>, O = x;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">while</span> (h &lt;= t &amp;&amp; Scope(q[h], q[h + <span class="number">1</span>]) &lt; P[x]) h += <span class="number">1</span>;</div><div class="line">        f[x] = f[q[h]] + (dis[x] - dis[q[h]]) * P[x] + Q[x];</div><div class="line">        <span class="keyword">while</span> (h &lt;= t &amp;&amp; Scope(q[t], x) &lt; Scope(q[t - <span class="number">1</span>], q[t])) t -= <span class="number">1</span>;</div><div class="line">        H = h, T= t + <span class="number">1</span>, O = q[T]; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; o;</div><div class="line">        q[t += <span class="number">1</span>] = x;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = e[i].nxt) &#123;</div><div class="line">        o = dfs(e[i].v);</div><div class="line">        h = H, t = T, q[o.first] = o.second;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> make_pair(T, O);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">4</div><div class="line">1 1 1 3</div><div class="line">2 1 2 3</div><div class="line">3 1 3 3</div><div class="line">*/</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%lld%lld"</span>, &amp;f[i], &amp;dis[i], &amp;P[i], &amp;Q[i]);</div><div class="line">        AddEdge(f[i], i, dis[i]);</div><div class="line">    &#125;</div><div class="line">    h = <span class="number">1</span>, t = <span class="number">0</span>;dfs(<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="P2044-NOI2012-随机数生成器"><a href="#P2044-NOI2012-随机数生成器" class="headerlink" title="P2044 [NOI2012]随机数生成器"></a>P2044 [NOI2012]随机数生成器</h2><h3 id="Description-7"><a href="#Description-7" class="headerlink" title="Description"></a>Description</h3><p>栋栋最近迷上了随机算法，而随机数是生成随机算法的基础。栋栋准备使用线性同余法（Linear Congruential Method）来生成一个随机数列，这种方法需要设置四个非负整数参数m,a,c,X[0],按照下面的公式生成出一系列随机数{Xn}：</p>
<pre><code>X[n+1]=(aX[n]+c) mod m
</code></pre><p>其中mod m表示前面的数除以m的余数。从这个式子可以看出，这个序列的下一个数总是由上一个数生成的。</p>
<p>用这种方法生成的序列具有随机序列的性质，因此这种方法被广泛地使用，包括常用的C++和Pascal的产生随机数的库函数使用的也是这种方法。</p>
<p>栋栋知道这样产生的序列具有良好的随机性，不过心急的他仍然想尽快知道X[n]是多少。由于栋栋需要的随机数是0,1,…,g-1之间的，他需要将X[n]除以g取余得到他想要的数，即X[n] mod g，你只需要告诉栋栋他想要的数X[n] mod g是多少就可以了。</p>
<h3 id="Solution-7"><a href="#Solution-7" class="headerlink" title="Solution"></a>Solution</h3><p>构造矩阵<br>$$<br>A=<br>\begin{pmatrix}a&amp;0\\0&amp;1<br>\end{pmatrix}, B=\begin{pmatrix}X_0 \\1\end{pmatrix}\\<br>\begin{pmatrix}X_1 \\1\end{pmatrix}=\begin{pmatrix}a&amp;0\\0&amp;1<br>\end{pmatrix}\begin{pmatrix}X_0 \\1\end{pmatrix}\\<br>X_n = (A^nB)_{1,1}<br>$$<br>当然除了这种暴力之至的办法外还有更巧妙的算法.</p>
<h3 id="Code-7"><a href="#Code-7" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">7</span>;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> &#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> mod;</div><div class="line">    <span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">add</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>&#123; </div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>; </div><div class="line">        <span class="keyword">for</span>(;y;y &gt;&gt;= <span class="number">1</span>, x = x + x % mod) </div><div class="line">            <span class="keyword">if</span>(y &amp; <span class="number">1</span>) ret = ret + x % mod; </div><div class="line">        <span class="keyword">return</span> ret % mod; </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">struct</span> Matrix &#123;</div><div class="line">        <span class="keyword">int</span> r, c;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> m[<span class="number">3</span>][<span class="number">3</span>];</div><div class="line">        Matrix () &#123; <span class="built_in">memset</span>(m, <span class="literal">false</span>, <span class="keyword">sizeof</span> m); &#125;</div><div class="line">        Matrix (<span class="keyword">int</span> n, <span class="keyword">int</span> m) :Matrix() &#123; r = n, c = m; &#125;</div><div class="line">        Matrix (<span class="keyword">int</span> n) :Matrix() &#123; r = c = n; m[<span class="number">0</span>][<span class="number">0</span>] = m[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1l</span>l; &#125;</div><div class="line">        Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix &amp;o) <span class="keyword">const</span> &#123;</div><div class="line">            Matrix res = Matrix (r, o.c);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r; i += <span class="number">1</span>)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; o.c; j += <span class="number">1</span>)</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; c; k += <span class="number">1</span>)</div><div class="line">                res.m[i][j] += add(m[i][k], o.m[k][j]),</div><div class="line">                res.m[i][j] %= mod;</div><div class="line">            <span class="keyword">return</span> res;</div><div class="line">        &#125;</div><div class="line">        Matrix <span class="keyword">operator</span> ^ (<span class="keyword">long</span> <span class="keyword">long</span> o) <span class="keyword">const</span> &#123;</div><div class="line">            Matrix base = *<span class="keyword">this</span>;</div><div class="line">            Matrix resl = Matrix (r);</div><div class="line">            <span class="keyword">while</span> (o) &#123;</div><div class="line">                <span class="keyword">if</span> (o &amp; <span class="number">1l</span>l)</div><div class="line">                    resl = resl * base;</div><div class="line">                base = base * base;</div><div class="line">                o &gt;&gt;= <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> resl;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125; <span class="comment">//Get The Fibnacci Sequence ! </span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> D <span class="meta-string">"%lld"</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Read(T) scanf(D, &amp;T)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Write(T) printf(D, T),putchar(<span class="meta-string">'\n'</span>)</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> m, a, c, x, n, g; </div><div class="line">    Read(m); Read(a); Read(c); Read(x); Read(n); Read(g); </div><div class="line">    Matrix res = Matrix(<span class="number">2</span>, <span class="number">2</span>), tmp = Matrix(<span class="number">2</span>, <span class="number">1</span>);</div><div class="line">    res.m[<span class="number">0</span>][<span class="number">0</span>] = a, res.m[<span class="number">0</span>][<span class="number">1</span>] = res.m[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">    tmp.m[<span class="number">0</span>][<span class="number">0</span>] = x, tmp.m[<span class="number">1</span>][<span class="number">0</span>] = c; mod = m;</div><div class="line">    res = (res ^ n) * tmp;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, res.m[<span class="number">0</span>][<span class="number">0</span>] % g);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P4427-BJOI2018-求和"><a href="#P4427-BJOI2018-求和" class="headerlink" title="P4427 [BJOI2018]求和"></a>P4427 [BJOI2018]求和</h2><h3 id="Description-8"><a href="#Description-8" class="headerlink" title="Description"></a>Description</h3><p>master 对树上的求和非常感兴趣。他生成了一棵有根树，并且希望多次询问这棵树上一段路径上所有节点深度的 k 次方和，而且每次的 k 可能是不同的。此处节点深度的定义是这个节点到根的路径上的边数。他把这个问题交给了pupil，但pupil 并不会这么复杂的操作，你能帮他解决吗？</p>
<h3 id="Solution-8"><a href="#Solution-8" class="headerlink" title="Solution"></a>Solution</h3><p>预处理出$\sum_{i=1}^ni^k$的前缀和, 对于树上的一段路径, 求出lca, 利用前缀和直接得到答案.</p>
<h3 id="Code-8"><a href="#Code-8" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: swap;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> v, nxt;</div><div class="line">&#125;e[N &lt;&lt; <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> head[N], tot;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    e[++tot] = (Edge) &#123;v, head[u]&#125;; head[u] = tot;</div><div class="line">    e[++tot] = (Edge) &#123;u, head[v]&#125;; head[v] = tot;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> f[N][<span class="number">20</span>], dep[N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = e[i].nxt) &#123;</div><div class="line">        <span class="keyword">if</span> (e[i].v == f[x][<span class="number">0</span>]) <span class="keyword">continue</span>;</div><div class="line">        f[e[i].v][<span class="number">0</span>] = x, dep[e[i].v] = dep[x] + <span class="number">1</span>;</div><div class="line">        dfs(e[i].v);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> Sum[<span class="number">51</span>][N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> res = <span class="number">1l</span>l, tmp = a;</div><div class="line">    <span class="keyword">while</span> (b) &#123;</div><div class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = <span class="number">1l</span>l * res * tmp % mod;</div><div class="line">        tmp = <span class="number">1l</span>l * tmp * tmp % mod;</div><div class="line">        b &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res % mod;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    dep[<span class="number">0</span>] = <span class="number">-1</span>; dfs(<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">20</span>; i += <span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j += <span class="number">1</span>) &#123;</div><div class="line">            f[j][i] = f[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">50</span>; i += <span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j += <span class="number">1</span>)</div><div class="line">            Sum[i][j] = (Sum[i][j - <span class="number">1</span>] + Pow(j, i)) % mod;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (dep[x] &lt; dep[y]) swap (x, y);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; ~i; i -= <span class="number">1</span>)</div><div class="line">        <span class="keyword">if</span> (dep[f[x][i]] &gt;= dep[y])</div><div class="line">            x = f[x][i];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; ~i; i -= <span class="number">1</span>)</div><div class="line">        <span class="keyword">if</span> (f[x][i] != f[y][i])</div><div class="line">            x = f[x][i], y = f[y][i];</div><div class="line">    <span class="keyword">return</span> (x == y ? x : f[x][<span class="number">0</span>]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n); <span class="keyword">int</span> u, v, k;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</div><div class="line">        AddEdge(u, v);</div><div class="line">    &#125;</div><div class="line">    init(n); <span class="keyword">int</span> m;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;k);</div><div class="line">        <span class="keyword">int</span> lca = Lca (u, v);</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</div><div class="line">        ans -= (Sum[k][dep[lca]] + Sum[k][dep[f[lca][<span class="number">0</span>]]]) % mod;</div><div class="line">        ans += (Sum[k][dep[u]] + Sum[k][dep[v]]) % mod;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans % mod + mod) % mod);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P3950-部落冲突"><a href="#P3950-部落冲突" class="headerlink" title="P3950 部落冲突"></a>P3950 部落冲突</h2><h3 id="Description-9"><a href="#Description-9" class="headerlink" title="Description"></a>Description</h3><p>给一棵树, 三种操作:</p>
<ul>
<li>将一条边断开</li>
<li>询问两个点是否联通</li>
<li>连起之前断过的一条边</li>
</ul>
<h3 id="Solution-9"><a href="#Solution-9" class="headerlink" title="Solution"></a>Solution</h3><p>做法很多, 但是都很暴力.<br>Link-Cut-Tree和树链剖分都可以.</p>
<h3 id="Code-9"><a href="#Code-9" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 300005</span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: swap;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> War&#123;</div><div class="line">    <span class="keyword">int</span> u,v;</div><div class="line">&#125;w[N];</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> &#123;</div><div class="line">    <span class="keyword">int</span> n,m,ch[N][<span class="number">2</span>],fa[N],st[N],top;</div><div class="line">    <span class="keyword">bool</span> rev[N];</div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> makeroot(x) Access(x);splay(x);rev[x]^=1;</span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> Link(x,y) makeroot(x);fa[x]=y;</span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> cut(x,y) makeroot(x);Access(y);splay(y);<span class="meta-keyword">if</span>(ch[y][0]==x) fa[x]=ch[y][0]=0;</span></div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">0</span>]!=x&amp;&amp;ch[fa[x]][<span class="number">1</span>]!=x; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(rev[x])&#123;</div><div class="line">            swap(ch[x][<span class="number">0</span>],ch[x][<span class="number">1</span>]); rev[x]=<span class="number">0</span>;</div><div class="line">            rev[ch[x][<span class="number">0</span>]]^=<span class="number">1</span>; rev[ch[x][<span class="number">1</span>]]^=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> y=fa[x],z=fa[y],l=ch[y][<span class="number">1</span>]==x,r=l^<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(!isroot(y)) ch[z][ch[z][<span class="number">1</span>]==y]=x;</div><div class="line">        fa[x]=z; fa[y]=x; fa[ch[x][r]]=y;</div><div class="line">        ch[y][l]=ch[x][r]; ch[x][r]=y;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">        st[++top]=x;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=x;!isroot(i);i=fa[i]) st[++top]=fa[i];</div><div class="line">        <span class="keyword">while</span>(top) pushdown(st[top--]);</div><div class="line">        <span class="keyword">while</span>(!isroot(x))&#123;</div><div class="line">            <span class="keyword">int</span> y=fa[x],z=fa[y];</div><div class="line">            <span class="keyword">if</span>(!isroot(y))&#123;</div><div class="line">                <span class="keyword">if</span>(ch[y][<span class="number">0</span>]==x^ch[z][<span class="number">0</span>]==y) rotate(x);</div><div class="line">                <span class="keyword">else</span> rotate(y);</div><div class="line">            &#125;</div><div class="line">            rotate(x);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">0</span>; x; y = x, x = fa[x]) splay(x), ch[x][<span class="number">1</span>]=y; &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findrt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">while</span>(fa[x]) x=fa[x]; <span class="keyword">return</span> x; &#125;</div><div class="line">&#125;<span class="comment">//Link Cut Tree</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> x,y,t=<span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">        Link(x,y);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span>(m--)&#123;</div><div class="line">        <span class="keyword">char</span> opt=<span class="string">' '</span>;</div><div class="line">        <span class="keyword">while</span>(opt!=<span class="string">'Q'</span>&amp;&amp;opt!=<span class="string">'C'</span>&amp;&amp;opt!=<span class="string">'U'</span>) opt=getchar();</div><div class="line">        <span class="keyword">if</span>(opt==<span class="string">'Q'</span>)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">            <span class="keyword">if</span>(findrt(x)==findrt(y)) <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</div><div class="line">            <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="string">'C'</span>)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">            w[++t]=(War)&#123;x,y&#125;;</div><div class="line">            cut(x,y);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</div><div class="line">            <span class="keyword">if</span>(x&gt;t) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">if</span>(findrt(w[x].u)!=findrt(w[x].v)) &#123;</div><div class="line">                Link(w[x].u,w[x].v);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="1688-Usaco2005-Open-Disease-Manangement-疾病管理"><a href="#1688-Usaco2005-Open-Disease-Manangement-疾病管理" class="headerlink" title="1688: [Usaco2005 Open]Disease Manangement 疾病管理"></a>1688: [Usaco2005 Open]Disease Manangement 疾病管理</h2><h3 id="Description-10"><a href="#Description-10" class="headerlink" title="Description"></a>Description</h3><p>Alas! A set of D (1 &lt;= D &lt;= 15) diseases (numbered 1..D) is running through the farm. Farmer John would like to milk as many of his N (1 &lt;= N &lt;= 1,000) cows as possible. If the milked cows carry more than K (1 &lt;= K &lt;= D) different diseases among them, then the milk will be too contaminated and will have to be discarded in its entirety. Please help determine the largest number of cows FJ can milk without having to discard the milk. </p>
<h2 id="Solution-10"><a href="#Solution-10" class="headerlink" title="Solution"></a>Solution</h2><p>状态压缩动态规划</p>
<h2 id="Code-10"><a href="#Code-10" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1</span> &lt;&lt; <span class="number">17</span>;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> f[N], num[N];</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> n, d, k;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;d, &amp;k);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; (<span class="number">1</span> &lt;&lt; d); i ++ )</div><div class="line">        num[i] = num[i - (i &amp; (-i))] + <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )&#123;</div><div class="line">        <span class="keyword">int</span> siz, sum = <span class="number">0</span>, tmp;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;siz);</div><div class="line">        <span class="keyword">while</span> (siz--)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;tmp);</div><div class="line">            sum |= <span class="number">1</span> &lt;&lt; (tmp - <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = (<span class="number">1</span> &lt;&lt; d) - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j -- )&#123;</div><div class="line">            <span class="keyword">if</span> (num[j | sum] &lt;= k)&#123;</div><div class="line">                f[j | sum] = max(f[j | sum], f[j] + <span class="number">1</span>);</div><div class="line">                ans = max(ans, f[j | sum]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2073-POI2004-PRZ"><a href="#2073-POI2004-PRZ" class="headerlink" title="2073: [POI2004]PRZ"></a>2073: [POI2004]PRZ</h2><h3 id="Description-11"><a href="#Description-11" class="headerlink" title="Description"></a>Description</h3><p>一只队伍在爬山时碰到了雪崩,他们在逃跑时遇到了一座桥,他们要尽快的过桥. 桥已经很旧了, 所以它不能承受太重的东西. 任何时候队伍在桥上的人都不能超过一定的限制. 所以这只队伍过桥时只能分批过,当一组全部过去时,下一组才能接着过. 队伍里每个人过桥都需要特定的时间,当一批队员过桥时时间应该算走得最慢的那一个,每个人也有特定的重量,我们想知道如何分批过桥能使总时间最少. </p>
<h3 id="Solution-11"><a href="#Solution-11" class="headerlink" title="Solution"></a>Solution</h3><p>枚举子集状态压缩dp</p>
<h3 id="Code-11"><a href="#Code-11" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: min;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: max;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> Max = <span class="number">65537</span>;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> f[Max], tim[Max], sum[Max];</div><div class="line"><span class="keyword">int</span> t[<span class="number">17</span>], w[<span class="number">17</span>];</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> m, n;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;m , &amp;n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;t[i], &amp;w[i]);</div><div class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</div><div class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n) ; i ++ )</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n ; j ++ )</div><div class="line">            <span class="keyword">if</span>((<span class="number">1</span> &lt;&lt; j) &amp; i)</div><div class="line">                tim[i] = max(tim[i], t[j]), sum[i] += w[j];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i ++ )</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j; j = i &amp; (j - <span class="number">1</span>))</div><div class="line">            <span class="keyword">if</span>(sum[j] &lt;= m)</div><div class="line">                f[i] = min(f[i], f[i ^ j] + tim[j]);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P4305-JLOI2011-不重复数字"><a href="#P4305-JLOI2011-不重复数字" class="headerlink" title="P4305 [JLOI2011]不重复数字"></a>P4305 [JLOI2011]不重复数字</h2><h3 id="Description-12"><a href="#Description-12" class="headerlink" title="Description"></a>Description</h3><p>给出N个数，要求把其中重复的去掉，只保留第一次出现的数。</p>
<p>例如，给出的数为1 2 18 3 3 19 2 3 6 5 4，其中2和3有重复，去除后的结果为1 2 18 3 19 6 5 4。</p>
<h3 id="Solution-12"><a href="#Solution-12" class="headerlink" title="Solution"></a>Solution</h3><p>随便做</p>
<h3 id="Code-12"><a href="#Code-12" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">    <span class="keyword">bool</span> isexist;</div><div class="line">    Node *ch[<span class="number">2</span>];</div><div class="line">    Node () &#123; ch[<span class="number">0</span>] = ch[<span class="number">1</span>] = <span class="literal">NULL</span>, isexist = <span class="literal">false</span>; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">0</span>]) ch[<span class="number">0</span>]-&gt;clear();</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">1</span>]) ch[<span class="number">1</span>]-&gt;clear();</div><div class="line">        <span class="keyword">delete</span> <span class="keyword">this</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">class</span> Trie &#123;</div><div class="line">    Node *root;</div><div class="line"><span class="keyword">public</span>: </div><div class="line">    Trie() &#123; root = <span class="keyword">new</span> Node(); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; root-&gt;clear(); &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">        Node *node = root;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">30</span>; ~i; i -= <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">bool</span> pos = num &amp; (<span class="number">1</span> &lt;&lt; i);</div><div class="line">            <span class="keyword">if</span> (node-&gt;ch[pos])</div><div class="line">                node-&gt;ch[pos] = <span class="keyword">new</span> Node ();</div><div class="line">            node = node-&gt;ch[pos];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> node-&gt;isexist ? <span class="literal">false</span> : node-&gt;isexist = <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> T, n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</div><div class="line">    <span class="keyword">while</span> (T--) &#123;</div><div class="line">        Trie *T = <span class="keyword">new</span> Trie();</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n); <span class="keyword">int</span> tmp;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;tmp); </div><div class="line">            <span class="keyword">if</span> (T-&gt;insert(tmp)) </div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%d "</span>, tmp);</div><div class="line">        &#125;</div><div class="line">        T-&gt;clear(); <span class="keyword">delete</span> T; T = <span class="literal">NULL</span>;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P3833-SHOI2012-魔法树"><a href="#P3833-SHOI2012-魔法树" class="headerlink" title="P3833 [SHOI2012]魔法树"></a>P3833 [SHOI2012]魔法树</h2><h3 id="Description-13"><a href="#Description-13" class="headerlink" title="Description"></a>Description</h3><p>Harry Potter 新学了一种魔法：可以让改变树上的果子个数。满心欢喜的他找到了一个巨大的果树，来试验他的新法术。</p>
<p>这棵果树共有N个节点，其中节点0是根节点，每个节点u的父亲记为fa[u]，保证有fa[u] &lt; u。初始时，这棵果树上的果子都被 Dumbledore 用魔法清除掉了，所以这个果树的每个节点上都没有果子（即0个果子）。</p>
<p>不幸的是，Harry 的法术学得不到位，只能对树上一段路径的节点上的果子个数统一增加一定的数量。也就是说，Harry 的魔法可以这样描述：</p>
<pre><code>Add u v d
</code></pre><p>表示将点u和v之间的路径上的所有节点的果子个数都加上d。</p>
<p>接下来，为了方便检验 Harry 的魔法是否成功，你需要告诉他在释放魔法的过程中的一些有关果树的信息：</p>
<pre><code>Query u
</code></pre><p>表示当前果树中，以点u为根的子树中，总共有多少个果子？</p>
<h3 id="Solution-13"><a href="#Solution-13" class="headerlink" title="Solution"></a>Solution</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000005</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">2</span>*<span class="number">1e6</span>+<span class="number">10</span>;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="comment">// inline char nc()&#123;</span></div><div class="line"><span class="comment">//     static char buf[MAXN],*p1=buf,*p2=buf;</span></div><div class="line"><span class="comment">//     return p1==p2&amp;&amp;(p2=(p1=buf)+fread(buf,1,MAXN,stdin),p1==p2)?EOF:*p1++;</span></div><div class="line"><span class="comment">// &#125;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> nc() getchar()</span></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">char</span> c=nc();<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(c==<span class="string">'-'</span>)f=<span class="number">-1</span>;c=nc();&#125;</div><div class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+c-<span class="string">'0'</span>,c=nc();&#125;</div><div class="line">    <span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> h[N];</div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> Tree&#123;</div><div class="line">    <span class="keyword">struct</span> Edge&#123;</div><div class="line">        <span class="keyword">int</span> v,nxt;</div><div class="line">    &#125;e[N];</div><div class="line">    <span class="keyword">int</span> head[N],tot;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">        e[++tot]=(Edge)&#123;v,head[u]&#125;;head[u]=tot;</div><div class="line">        e[++tot]=(Edge)&#123;u,head[v]&#125;;head[v]=tot;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> siz[N],son[N],dep[N],p[N];</div><div class="line">    <span class="keyword">int</span> fa[N],top[N],id[N];</div><div class="line">    <span class="keyword">int</span> The_Sum_Of_Id;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">        fa[x]=f,dep[x]=dep[f]+<span class="number">1</span>,siz[x]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">            <span class="keyword">if</span>(e[i].v==f)<span class="keyword">continue</span>;</div><div class="line">            dfs1(e[i].v,x);</div><div class="line">            siz[x]+=siz[e[i].v];</div><div class="line">            <span class="keyword">if</span>(!son[x]||siz[e[i].v]&gt;siz[son[x]])</div><div class="line">                son[x]=e[i].v;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> tp)</span></span>&#123;</div><div class="line">        top[x]=tp,id[x]=++The_Sum_Of_Id;</div><div class="line">        p[The_Sum_Of_Id]=h[x];</div><div class="line">        <span class="keyword">if</span>(!son[x])<span class="keyword">return</span>;dfs2(son[x],tp);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)</div><div class="line">            <span class="keyword">if</span>(e[i].v!=son[x]&amp;&amp;e[i].v!=fa[x])</div><div class="line">                dfs2(e[i].v,e[i].v);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">namespace</span> ST&#123;</div><div class="line">    <span class="keyword">struct</span> Node&#123;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> v,f;</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">DownFlag</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">static</span> Node t[N&lt;&lt;<span class="number">2</span>];</div><div class="line">    <span class="keyword">void</span> Node::merge(<span class="keyword">int</span> flag,<span class="keyword">int</span> l,<span class="keyword">int</span> r)&#123;</div><div class="line">        <span class="keyword">this</span>-&gt;v+=(r-l+<span class="number">1</span>)*flag;</div><div class="line">        <span class="keyword">this</span>-&gt;f+=flag;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">void</span> Node::DownFlag(<span class="keyword">int</span> id,<span class="keyword">int</span> l,<span class="keyword">int</span> r)&#123;</div><div class="line">        t[id&lt;&lt;<span class="number">1</span>].merge(<span class="keyword">this</span>-&gt;f,l,l+r&gt;&gt;<span class="number">1</span>);</div><div class="line">        t[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].merge(<span class="keyword">this</span>-&gt;f,(l+r&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>,r);</div><div class="line">        <span class="keyword">this</span>-&gt;f=<span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">void</span> Node::update(<span class="keyword">int</span> id)&#123;</div><div class="line">        <span class="keyword">this</span>-&gt;v=t[id&lt;&lt;<span class="number">1</span>].v+t[id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].v;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> ret)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(l==r)&#123;</div><div class="line">            t[ret].v=Tree::p[l];</div><div class="line">            <span class="keyword">return</span> ;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">        build(l,mid,ret&lt;&lt;<span class="number">1</span>);</div><div class="line">        build(mid+<span class="number">1</span>,r,ret&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</div><div class="line">        t[ret].update(ret);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Addition</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">long</span> <span class="keyword">long</span> k,<span class="keyword">int</span> id)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(l&gt;=L&amp;&amp;r&lt;=R)<span class="keyword">return</span> t[id].merge(k,l,r);</div><div class="line">        t[id].DownFlag(id,l,r);</div><div class="line">        <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(L&lt;=mid)Addition(l,mid,L,R,k,id&lt;&lt;<span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span>(R&gt;mid)Addition(mid+<span class="number">1</span>,r,L,R,k,id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</div><div class="line">        t[id].update(id);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> id)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(l&gt;=L&amp;&amp;r&lt;=R)<span class="keyword">return</span> t[id].v;</div><div class="line">        t[id].DownFlag(id,l,r);</div><div class="line">        <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;<span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(L&lt;=mid)ans+=query(l,mid,L,R,id&lt;&lt;<span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span>(R&gt;mid)ans+=query(mid+<span class="number">1</span>,r,L,R,id&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">namespace</span> Operate&#123;</div><div class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Tree;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Addition</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> a=top[l],b=top[r];</div><div class="line">        <span class="keyword">while</span>(a!=b)&#123;</div><div class="line">            <span class="keyword">if</span>(dep[a]&lt;dep[b])swap(a,b),swap(l,r);</div><div class="line">            ST::Addition(<span class="number">1</span>,n,id[a],id[l],k,<span class="number">1</span>);</div><div class="line">            l=fa[a],a=top[l],b=top[r];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(l!=r)<span class="keyword">if</span>(id[r]&lt;id[l])swap(l,r);</div><div class="line">        ST::Addition(<span class="number">1</span>,n,id[l],id[r],k,<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Addition</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">        ST::Addition(<span class="number">1</span>,n,id[x],id[x]+siz[x]<span class="number">-1</span>,k,<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> a=top[l],b=top[r];</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(a!=b)&#123;</div><div class="line">            <span class="keyword">if</span>(dep[a]&lt;dep[b])swap(a,b),swap(l,r);</div><div class="line">            ans+=ST::query(<span class="number">1</span>,n,id[a],id[l],<span class="number">1</span>);</div><div class="line">            l=fa[a],a=top[l],b=top[r];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(l!=r)<span class="keyword">if</span>(id[r]&lt;id[l])swap(l,r);</div><div class="line">        ans+=ST::query(<span class="number">1</span>,n,id[l],id[r],<span class="number">1</span>);</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> ST::query(<span class="number">1</span>,n,id[x],id[x]+siz[x]<span class="number">-1</span>,<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> u,v,r=<span class="number">1</span>;</div><div class="line">    n=read();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">        u=read(),v=read();</div><div class="line">        Tree::AddEdge(u + <span class="number">1</span>,v + <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    Tree::dfs1(r,<span class="number">0</span>),Tree::dfs2(r,r);</div><div class="line">    ST::build(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> x,y,z; <span class="built_in">string</span> str;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</div><div class="line">    <span class="keyword">while</span>(m--)&#123;</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; str; x=read();</div><div class="line">        <span class="keyword">if</span>(str==<span class="string">"A"</span>)&#123;</div><div class="line">            y=read(),z=read();</div><div class="line">            Operate::Addition(x + <span class="number">1</span>,y + <span class="number">1</span>,z);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(str==<span class="string">"Q"</span>)&#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,Operate::Query(x + <span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P1637-三元上升子序列"><a href="#P1637-三元上升子序列" class="headerlink" title="P1637 三元上升子序列"></a>P1637 三元上升子序列</h2><h3 id="Description-14"><a href="#Description-14" class="headerlink" title="Description"></a>Description</h3><p>Erwin最近对一种叫”thair”的东西巨感兴趣。。。</p>
<p>在含有n个整数的序列a1,a2……an中，</p>
<p>三个数被称作”thair”当且仅当i&lt;j&lt;k且ai&lt;aj&lt;ak</p>
<p>求一个序列中”thair”的个数。</p>
<h3 id="Solution-14"><a href="#Solution-14" class="headerlink" title="Solution"></a>Solution</h3><p>枚举中间那个数, 求出它前面的比他小的数的个数和他后面的比它大的数的个数.可以用权值线段树或者树状数组.</p>
<h3 id="Code-13"><a href="#Code-13" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">map</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: sort;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: unique;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">    <span class="keyword">int</span> cnt;</div><div class="line">    Node *ls, *rs;</div><div class="line">    Node () &#123; cnt = <span class="number">0</span>, ls = rs = <span class="literal">NULL</span>; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Merge</span><span class="params">()</span> </span>&#123; cnt = ls-&gt;cnt + rs-&gt;cnt; &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">class</span> SegmentTree&#123;</div><div class="line">    Node *root; <span class="keyword">int</span> n;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    SegmentTree() &#123; root = <span class="keyword">new</span> Node(); &#125;</div><div class="line">    SegmentTree(<span class="keyword">int</span> _) : SegmentTree() &#123; n = _; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, Node *node)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</div><div class="line">        <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</div><div class="line">        node-&gt;ls = <span class="keyword">new</span> Node();</div><div class="line">        node-&gt;rs = <span class="keyword">new</span> Node();</div><div class="line">        build(l, mid, node-&gt;ls);</div><div class="line">        build(mid + <span class="number">1</span>, r, node-&gt;rs);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exit</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, Node *node, <span class="keyword">int</span> p)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> node-&gt;cnt += <span class="number">1</span>, <span class="built_in">exit</span>();</div><div class="line">        <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (p &gt; mid) add(mid + <span class="number">1</span>, r, node-&gt;rs, p);</div><div class="line">        <span class="keyword">else</span>         add(l, mid, node-&gt;ls, p);</div><div class="line">        node-&gt;Merge();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, Node *node)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (l &gt;= L &amp;&amp; R &gt;= r)</div><div class="line">            <span class="keyword">return</span> node-&gt;cnt;</div><div class="line">        <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>, ans = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (L &lt;= mid) ans += query(l, mid, L, R, node-&gt;ls);</div><div class="line">        <span class="keyword">if</span> (R &gt; mid) ans += query(mid + <span class="number">1</span>, r, L, R, node-&gt;rs);</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Build</span><span class="params">()</span> </span>&#123; build(<span class="number">1</span>, n, root); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Addition</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123; add(<span class="number">1</span>, n, root, p); &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">QueryLeft</span><span class="params">(<span class="keyword">int</span> R)</span> </span>&#123; <span class="keyword">return</span> R &lt; <span class="number">1</span> ? <span class="number">0</span> : query(<span class="number">1</span>, n, <span class="number">1</span>, R, root); &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">QueryRight</span><span class="params">(<span class="keyword">int</span> L)</span> </span>&#123; <span class="keyword">return</span> L &gt; n ? <span class="number">0</span> : query(<span class="number">1</span>, n, L, n, root); &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">30005</span>;</div><div class="line"><span class="keyword">int</span> seq[N], s[N];</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; M;</div><div class="line"><span class="keyword">int</span> L[N], R[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;seq[i]), s[i] = seq[i];</div><div class="line">    sort (s, s + n); <span class="keyword">int</span> m = unique(s, s + n) - s; </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i += <span class="number">1</span>) M[s[i]] = i + <span class="number">1</span>;</div><div class="line">    SegmentTree *T = <span class="keyword">new</span> SegmentTree(m); T-&gt;Build(); </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>)</div><div class="line">        T-&gt;Addition(M[seq[i]]), L[i] = T-&gt;QueryLeft(M[seq[i]] - <span class="number">1</span>);</div><div class="line">    <span class="keyword">delete</span> T; T = <span class="keyword">new</span> SegmentTree(m); T-&gt;Build();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; ~i; i -= <span class="number">1</span>)</div><div class="line">        T-&gt;Addition(M[seq[i]]), R[i] = T-&gt;QueryRight(M[seq[i]] + <span class="number">1</span>);</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>) res += <span class="number">1l</span>l * L[i] * R[i];</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P3398-仓鼠找sugar"><a href="#P3398-仓鼠找sugar" class="headerlink" title="P3398 仓鼠找sugar"></a>P3398 仓鼠找sugar</h2><h3 id="Description-15"><a href="#Description-15" class="headerlink" title="Description"></a>Description</h3><p>小仓鼠的和他的基（mei）友（zi）sugar住在地下洞穴中，每个节点的编号为1~n。地下洞穴是一个树形结构。这一天小仓鼠打算从从他的卧室（a）到餐厅（b），而他的基友同时要从他的卧室（c）到图书馆（d）。他们都会走最短路径。现在小仓鼠希望知道，有没有可能在某个地方，可以碰到他的基友？</p>
<p>小仓鼠那么弱，还要天天被zzq大爷虐，请你快来救救他吧！</p>
<h3 id="Solution-15"><a href="#Solution-15" class="headerlink" title="Solution"></a>Solution</h3><p>考虑如何判断树上的两条路径是否相交.</p>
<p>首先假设两条链分别是$(u_1,v_1),(u_2,v_2)$, 其最近公共祖先分别为$l_1,l_2$.设$depth_{l_1}\ge depth_{l_2}$.<br><img src="https://i.loli.net/2018/08/19/5b78b99caa460.png" alt=""><br>发现若两条链有公共边, 则$l_1$一定位于链$(u_2,v_2)$上, 因为若两条链有相交, 则相交的一条边往上但不到lca的边一定也相交.</p>
<p>再判断一下$l_1$是否位于第二条链上就好了.</p>
<h3 id="Code-14"><a href="#Code-14" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100006</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> v, nxt;</div><div class="line">&#125;e[N &lt;&lt; <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> head[N], tot;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    e[++tot] = (Edge) &#123; v, head[u]&#125;; head[u] = tot;</div><div class="line">    e[++tot] = (Edge) &#123; u, head[v]&#125;; head[v] = tot;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">int</span> f[N][<span class="number">20</span>];</div><div class="line"><span class="keyword">int</span> dep[N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = e[i].nxt) &#123;</div><div class="line">        <span class="keyword">if</span> (e[i].v == f[x][<span class="number">0</span>]) <span class="keyword">continue</span>;</div><div class="line">        f[e[i].v][<span class="number">0</span>] = x, dep[e[i].v] = dep[x] + <span class="number">1</span>, dfs(e[i].v);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">    dep[<span class="number">0</span>] = <span class="number">-1</span>; dfs(<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">20</span>; i += <span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j += <span class="number">1</span>)</div><div class="line">            f[j][i] = f[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) <span class="built_in">std</span>:: swap(u, v);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; ~i; i -= <span class="number">1</span>)</div><div class="line">        <span class="keyword">if</span> (dep[f[u][i]] &gt;= dep[v])</div><div class="line">            u = f[u][i];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; ~i; i -= <span class="number">1</span>)</div><div class="line">        <span class="keyword">if</span> (f[u][i] != f[v][i])</div><div class="line">            u = f[u][i], v = f[v][i];</div><div class="line">    <span class="keyword">return</span> u == v ? u : f[u][<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> q; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;q);</div><div class="line">    <span class="keyword">int</span> u, v;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</div><div class="line">        AddEdge(u, v);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> a, b;</div><div class="line">    init();</div><div class="line">    <span class="keyword">while</span> (q--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;a, &amp;b, &amp;u, &amp;v);</div><div class="line">        <span class="keyword">if</span> (dep[lca(a, b)] &lt; dep[lca(u, v)]) </div><div class="line">            <span class="built_in">std</span>:: swap(u, a), <span class="built_in">std</span>:: swap(v, b);</div><div class="line">        <span class="keyword">int</span> Lca = lca(a, b);</div><div class="line">        <span class="keyword">if</span> (lca(u, Lca) == Lca or lca(v, Lca) == Lca)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Y\n"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"N\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P3110-USACO14DEC-驮运Piggy-Back"><a href="#P3110-USACO14DEC-驮运Piggy-Back" class="headerlink" title="P3110 [USACO14DEC]驮运Piggy Back"></a>P3110 [USACO14DEC]驮运Piggy Back</h2><h3 id="Description-16"><a href="#Description-16" class="headerlink" title="Description"></a>Description</h3><p>Bessie 和 Elsie在不同的区域放牧，他们希望花费最小的能量返回谷仓。从一个区域走到一个相连区域，Bessie要花费B单位的能量，Elsie要花费E单位的能量。</p>
<p>如果某次他们两走到同一个区域，Bessie 可以背着 Elsie走路，花费P单位的能量走到另外一个相连的区域。当然，存在P&gt;B+E的情况。</p>
<p>相遇后，他们可以一直背着走，也可以独立分开。</p>
<h3 id="Solution-16"><a href="#Solution-16" class="headerlink" title="Solution"></a>Solution</h3><p>只需要求出起点为1, 2, n的单源最短路, 再拼接一下构成完整的路径即可.</p>
<h3 id="Code-15"><a href="#Code-15" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">40005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">queue</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Read(___) scanf(<span class="meta-string">"%d"</span>, &amp;___)</span></div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge &#123;</div><div class="line">    <span class="keyword">int</span> v, c; Edge *nxt;</div><div class="line">    Edge() : nxt(<span class="literal">NULL</span>), v(<span class="number">0</span>), c(inf) &#123;&#125;</div><div class="line">    Edge(<span class="keyword">int</span> _, <span class="keyword">int</span> __) : nxt(<span class="literal">NULL</span>), v(_), c(__) &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">class</span> Graph &#123;</div><div class="line">    <span class="keyword">int</span> n, m, vis[N];</div><div class="line">    Edge *head[N];</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Graph(<span class="keyword">int</span> _) &#123; n = _; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i += <span class="number">1</span>) head[i] = <span class="keyword">new</span> Edge(); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">        Edge *tmp = head[u], *t = <span class="keyword">new</span> Edge(v, c); t-&gt;nxt = tmp, head[u] = t;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">InitGraph</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">bool</span> isdirect, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> u, v, c = val;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i += <span class="number">1</span>) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v); <span class="keyword">if</span> (!val) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;c);</div><div class="line">            AddEdge(u, v, c); <span class="keyword">if</span> (isdirect) AddEdge(v, u, c);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">MinDistance</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> *dis)</span> </span>&#123;</div><div class="line">        <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="number">4</span> * n + <span class="number">4</span>);</div><div class="line">        <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="number">4</span> * n + <span class="number">4</span>);</div><div class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</div><div class="line">        que.push(s), vis[s] = <span class="literal">true</span>, dis[s] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> top; !que.empty(); que.pop()) &#123;</div><div class="line">            top = que.front(); vis[top] = <span class="literal">false</span>;</div><div class="line">            <span class="keyword">for</span> (Edge *t = head[top]; t; t = t-&gt;nxt) &#123;</div><div class="line">                <span class="keyword">if</span> (dis[t-&gt;v] &gt; dis[top] + t-&gt;c) &#123;</div><div class="line">                    dis[t-&gt;v] = dis[top] + t-&gt;c;</div><div class="line">                    <span class="keyword">if</span> (!vis[t-&gt;v]) vis[t-&gt;v] = <span class="literal">true</span>, que.push(t-&gt;v);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> d1[N], d2[N], d3[N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m, p, b, e; <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d"</span>, &amp;b, &amp;e, &amp;p, &amp;n, &amp;m);</div><div class="line">    Graph *G = <span class="keyword">new</span> Graph(n); G-&gt;InitGraph(m, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">    G-&gt;MinDistance(<span class="number">1</span>, d1);</div><div class="line">    G-&gt;MinDistance(<span class="number">2</span>, d2);</div><div class="line">    G-&gt;MinDistance(n, d3);</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0x3f3f3f3f</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>) &#123;</div><div class="line">        res = <span class="built_in">std</span>:: min (res, d1[i] * b + d2[i] * e + d3[i] * p);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, res);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P2865-USACO06NOV-路障Roadblocks"><a href="#P2865-USACO06NOV-路障Roadblocks" class="headerlink" title="P2865 [USACO06NOV]路障Roadblocks"></a>P2865 [USACO06NOV]路障Roadblocks</h2><h3 id="Description-17"><a href="#Description-17" class="headerlink" title="Description"></a>Description</h3><p>贝茜把家搬到了一个小农场，但她常常回到FJ的农场去拜访她的朋友。贝茜很喜欢路边的风景，不想那么快地结束她的旅途，于是她每次回农场，都会选择第二短的路径，而不象我们所习惯的那样，选择最短路。 贝茜所在的乡村有R(1&lt;=R&lt;=100,000)条双向道路，每条路都联结了所有的N(1&lt;=N&lt;=5000)个农场中的某两个。贝茜居住在农场1，她的朋友们居住在农场N（即贝茜每次旅行的目的地）。 贝茜选择的第二短的路径中，可以包含任何一条在最短路中出现的道路，并且，一条路可以重复走多次。当然咯，第二短路的长度必须严格大于最短路（可能有多条）的长度，但它的长度必须不大于所有除最短路外的路径的长度。</p>
<h3 id="Solution-17"><a href="#Solution-17" class="headerlink" title="Solution"></a>Solution</h3><p>次短路Dijkstra</p>
<h3 id="Code-16"><a href="#Code-16" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">40005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: <span class="built_in">queue</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: pair;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: make_pair;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Read(___) scanf(<span class="meta-string">"%d"</span>, &amp;___)</span></div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge &#123;</div><div class="line">    <span class="keyword">int</span> v, c; Edge *nxt;</div><div class="line">    Edge() : nxt(<span class="literal">NULL</span>), v(<span class="number">0</span>), c(inf) &#123;&#125;</div><div class="line">    Edge(<span class="keyword">int</span> _, <span class="keyword">int</span> __) : nxt(<span class="literal">NULL</span>), v(_), c(__) &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">class</span> Graph &#123;</div><div class="line">    <span class="keyword">int</span> n, m, vis[N];</div><div class="line">    Edge *head[N];</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Graph(<span class="keyword">int</span> _) &#123; n = _; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i += <span class="number">1</span>) head[i] = <span class="keyword">new</span> Edge(); &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">        Edge *tmp = head[u], *t = <span class="keyword">new</span> Edge(v, c); t-&gt;nxt = tmp, head[u] = t;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">InitGraph</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">bool</span> isdirect, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> u, v, c = val;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i += <span class="number">1</span>) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v); <span class="keyword">if</span> (!val) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;c);</div><div class="line">            AddEdge(u, v, c); <span class="keyword">if</span> (isdirect) AddEdge(v, u, c);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">MinDistance</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> *dis)</span> </span>&#123;</div><div class="line">        <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="number">4</span> * n + <span class="number">4</span>);</div><div class="line">        <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="number">4</span> * n + <span class="number">4</span>);</div><div class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</div><div class="line">        que.push(s), vis[s] = <span class="literal">true</span>, dis[s] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> top; !que.empty(); que.pop()) &#123;</div><div class="line">            top = que.front(); vis[top] = <span class="literal">false</span>;</div><div class="line">            <span class="keyword">for</span> (Edge *t = head[top]; t; t = t-&gt;nxt) &#123;</div><div class="line">                <span class="keyword">if</span> (dis[t-&gt;v] &gt; dis[top] + t-&gt;c) &#123;</div><div class="line">                    dis[t-&gt;v] = dis[top] + t-&gt;c;</div><div class="line">                    <span class="keyword">if</span> (!vis[t-&gt;v]) vis[t-&gt;v] = <span class="literal">true</span>, que.push(t-&gt;v);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> P pair<span class="meta-string">&lt;int,int&gt; </span></span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">SecondaryShortCircuit</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> *dis, <span class="keyword">int</span> *sdis)</span> </span>&#123;</div><div class="line">        <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="number">4</span> * n + <span class="number">4</span>);</div><div class="line">        <span class="built_in">memset</span>(sdis, <span class="number">0x3f</span>, <span class="number">4</span> * n + <span class="number">4</span>);</div><div class="line">        <span class="built_in">std</span>:: priority_queue&lt;P, <span class="built_in">std</span>:: <span class="built_in">vector</span>&lt;P&gt; , <span class="built_in">std</span>:: greater&lt;P&gt; &gt;que;</div><div class="line">        dis[s] = <span class="number">0</span>, que.push(make_pair(<span class="number">0</span>, <span class="number">1</span>));</div><div class="line">        <span class="keyword">for</span> (P top; !que.empty(); que.pop()) &#123;</div><div class="line">            top = que.top(); <span class="keyword">int</span> t = top.second, d = top.first; </div><div class="line">            <span class="keyword">if</span> (sdis[t] &lt; top.first) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span> (Edge *i = head[t]; i; i = i-&gt;nxt) &#123;</div><div class="line">                <span class="keyword">int</span> D = d + i-&gt;c;</div><div class="line">                <span class="keyword">if</span> (dis[i-&gt;v] &gt; D) &#123;</div><div class="line">                    <span class="built_in">std</span>:: swap(dis[i-&gt;v], D);</div><div class="line">                    que.push(make_pair(dis[i-&gt;v], i-&gt;v));</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (sdis[i-&gt;v] &gt; D and dis[i-&gt;v] &lt; D) &#123;</div><div class="line">                    sdis[i-&gt;v] = D;</div><div class="line">                    que.push(make_pair(sdis[i-&gt;v], i-&gt;v));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> d1[N], d2[N], d3[N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">    Graph *G = <span class="keyword">new</span> Graph(n); G-&gt;InitGraph(m, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">    G-&gt;SecondaryShortCircuit(<span class="number">1</span>, d1, d2);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, d2[n]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P2002-消息扩散"><a href="#P2002-消息扩散" class="headerlink" title="P2002 消息扩散"></a>P2002 消息扩散</h2><h3 id="Description-18"><a href="#Description-18" class="headerlink" title="Description"></a>Description</h3><p>有n个城市，中间有单向道路连接，消息会沿着道路扩散，现在给出n个城市及其之间的道路，问至少需要在几个城市发布消息才能让这所有n个城市都得到消息。</p>
<h3 id="Solution-18"><a href="#Solution-18" class="headerlink" title="Solution"></a>Solution</h3><p>缩点, 求出入度为0的块的个数为答案</p>
<h3 id="Code-17"><a href="#Code-17" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100005</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: min;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge &#123;</div><div class="line">    <span class="keyword">int</span> v; Edge *nxt;</div><div class="line">    Edge() &#123; nxt = <span class="literal">NULL</span>; &#125;</div><div class="line">    Edge(<span class="keyword">int</span> _, Edge* __ = <span class="literal">NULL</span>) : nxt(__), v(_) &#123; &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">class</span> Graph &#123;</div><div class="line">    Edge *head[N]; <span class="keyword">int</span> n, cnt, tot, top;</div><div class="line">    <span class="keyword">int</span> dfn[N], low[N], vis[N], que[N], col[N], Du[N];</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Graph (<span class="keyword">int</span> _) : n(_) &#123; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i += <span class="number">1</span>) head[i] = <span class="literal">NULL</span>; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span> <span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        Edge *tmp = head[u], *t = <span class="keyword">new</span> Edge(v, tmp); head[u] = t;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        dfn[x] = low[x] = ++cnt, vis[x] = <span class="literal">true</span>, que[++top] = x;</div><div class="line">        <span class="keyword">for</span> (Edge *t = head[x]; t; t = t-&gt;nxt) &#123;</div><div class="line">            <span class="keyword">if</span> (!dfn[t-&gt;v]) Tarjan(t-&gt;v), low[x] = min(low[x], low[t-&gt;v]);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (vis[t-&gt;v]) low[x] = min(low[x], low[t-&gt;v]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (dfn[x] == low[x]) &#123;</div><div class="line">            vis[x] = <span class="literal">false</span>, col[x] = ++tot;</div><div class="line">            <span class="keyword">while</span> (que[top] != x) vis[que[top]] = <span class="literal">false</span>, col[que[top]] = tot, top -= <span class="number">1</span>;</div><div class="line">            top -= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ConnectSum</span><span class="params">()</span> </span>&#123;</div><div class="line">        cnt = tot = top = <span class="number">0</span>; <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span> vis);</div><div class="line">        <span class="built_in">memset</span>(dfn, <span class="literal">false</span>, <span class="keyword">sizeof</span> dfn); <span class="built_in">memset</span>(low, <span class="literal">false</span>, <span class="keyword">sizeof</span> low);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>) <span class="keyword">if</span> (!dfn[i]) Tarjan(i);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">            <span class="keyword">for</span> (Edge *t = head[i]; t; t = t-&gt;nxt)</div><div class="line">                <span class="keyword">if</span> (col[i] != col[t-&gt;v])</div><div class="line">                    Du[col[t-&gt;v]] += <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot; i += <span class="number">1</span>)</div><div class="line">            <span class="keyword">if</span> (!Du[i]) res += <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m); Graph *G = <span class="keyword">new</span> Graph(n);</div><div class="line">    <span class="keyword">int</span> u, v;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</div><div class="line">        G-&gt;AddEdge(u, v);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, G-&gt;ConnectSum());</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P1231教辅的组成"><a href="#P1231教辅的组成" class="headerlink" title="P1231教辅的组成"></a>P1231教辅的组成</h2><h3 id="Description-19"><a href="#Description-19" class="headerlink" title="Description"></a>Description</h3><p>蒟蒻HansBug在一本语文书里面发现了一本答案，然而他却明明记得这书应该还包含一份练习题。然而出现在他眼前的书多得数不胜数，其中有书，有答案，有练习册。已知一个完整的书册均应该包含且仅包含一本书、一本练习册和一份答案，然而现在全都乱做了一团。许多书上面的字迹都已经模糊了，然而HansBug还是可以大致判断这是一本书还是练习册或答案，并且能够大致知道一本书和答案以及一本书和练习册的对应关系（即仅仅知道某书和某答案、某书和某练习册有可能相对应，除此以外的均不可能对应）。既然如此，HansBug想知道在这样的情况下，最多可能同时组合成多少个完整的书册。</p>
<h3 id="Solution-19"><a href="#Solution-19" class="headerlink" title="Solution"></a>Solution</h3><p>最大流, 需要拆点</p>
<h3 id="Code-18"><a href="#Code-18" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 50005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> to,nxt,cap;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> que[N];</div><div class="line"><span class="keyword">int</span> h,qt;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Dinic&#123;</div><div class="line">    Edge e[N &lt;&lt; <span class="number">3</span>];</div><div class="line">    <span class="keyword">bool</span> vis[N];</div><div class="line">    <span class="keyword">int</span> tot,s,t,n;</div><div class="line">    <span class="keyword">int</span> d[N],cur[N],head[N];</div><div class="line">    Dinic()&#123;tot=<span class="number">1</span>;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">        e[++tot].to=v, e[tot].cap=f, e[tot].nxt=head[u], head[u]=tot;</div><div class="line">        e[++tot].to=u, e[tot].cap=<span class="number">0</span>, e[tot].nxt=head[v], head[v]=tot;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i)cur[i]=head[i];</div><div class="line">        que[qt=<span class="number">1</span>]=s,h=<span class="number">0</span>;<span class="keyword">int</span> top,to;d[s]=<span class="number">0</span>;vis[s]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(h&lt;qt)&#123;</div><div class="line">            top=que[++h];</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=head[top];i;i=e[i].nxt)</div><div class="line">                <span class="keyword">if</span>(!vis[e[i].to]&amp;&amp;e[i].cap)&#123;</div><div class="line">                    to=e[i].to;que[++qt]=to;</div><div class="line">                    vis[to]=<span class="literal">true</span>;d[to]=d[top]+<span class="number">1</span>;</div><div class="line">                    <span class="keyword">if</span>(to==t)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> vis[t];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fl)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(x==t)<span class="keyword">return</span> fl;</div><div class="line">        <span class="keyword">int</span> flow=<span class="number">0</span>,f,to;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> &amp;i=cur[x];i;i=e[i].nxt)&#123;</div><div class="line">            to=e[i].to;</div><div class="line">            <span class="keyword">if</span>(d[to]==d[x]+<span class="number">1</span>&amp;&amp;e[i].cap)</div><div class="line">            <span class="keyword">if</span>(f=dfs(to,min(fl,e[i].cap)))&#123;</div><div class="line">                e[i].cap-=f;fl-=f;</div><div class="line">                e[i^<span class="number">1</span>].cap+=f;flow+=f;</div><div class="line">                <span class="keyword">if</span>(fl&lt;=<span class="number">0</span>)<span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(fl)d[x]=<span class="number">-1</span>;</div><div class="line">        <span class="keyword">return</span> flow;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxflow</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>-&gt;s=s;<span class="keyword">this</span>-&gt;t=t;</div><div class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(bfs())ans+=dfs(s,inf);</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> id1[N], id2[N], id3[N], id4[N], s, t;</div><div class="line"><span class="keyword">static</span> <span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> n1, n2, n3; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n1, &amp;n2, &amp;n3);</div><div class="line">    s = ++cnt, t = ++cnt;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n1; i += <span class="number">1</span>) id1[i] = ++cnt;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n2; i += <span class="number">1</span>) id2[i] = ++cnt;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n2; i += <span class="number">1</span>) id3[i] = ++cnt;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n3; i += <span class="number">1</span>) id4[i] = ++cnt;</div><div class="line">    Dinic f; f.n=cnt;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n1; i += <span class="number">1</span>) f.add(s, id1[i], <span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n3; i += <span class="number">1</span>) f.add(id4[i], t, <span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n2; i += <span class="number">1</span>) f.add(id2[i], id3[i], <span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> m1, m2; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m1); <span class="keyword">int</span> u, v;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m1; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), f.add(id1[v], id2[u], <span class="number">1</span>);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m2);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m2; i += <span class="number">1</span>)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), f.add(id3[u], id4[v], <span class="number">1</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, f.maxflow(s, t));</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P1119-灾后重建"><a href="#P1119-灾后重建" class="headerlink" title="P1119 灾后重建"></a>P1119 灾后重建</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50005</span>, M = <span class="number">205</span>;</div><div class="line"></div><div class="line"><span class="keyword">bool</span> b[N];</div><div class="line"><span class="keyword">int</span> t[N],<span class="built_in">map</span>[M][M];</div><div class="line"><span class="keyword">int</span> from[N],to[N],day[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m, q;</div><div class="line">    <span class="built_in">memset</span> (<span class="built_in">map</span>, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> <span class="built_in">map</span>);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>) <span class="built_in">map</span>[i][i] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t[i]);</div><div class="line">    <span class="keyword">int</span> u, v, c;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;c);</div><div class="line">        <span class="built_in">map</span>[u][v] = <span class="built_in">map</span>[v][u] = c;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= q; l += <span class="number">1</span>) &#123;</div><div class="line">      <span class="keyword">int</span> U, V, T;</div><div class="line">      <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;U, &amp;V, &amp;T);</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k += <span class="number">1</span>)</div><div class="line">        <span class="keyword">if</span> (t[k] &lt;= T and !b[k]) &#123;</div><div class="line">          b[k] = <span class="number">1</span>;</div><div class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span> (i == k) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += <span class="number">1</span>)&#123;</div><div class="line">              <span class="keyword">if</span> (i == j or k == j) <span class="keyword">continue</span>;</div><div class="line">              <span class="keyword">if</span> (<span class="built_in">map</span>[i][j] &gt; <span class="built_in">map</span>[i][k] + <span class="built_in">map</span>[k][j])</div><div class="line">                <span class="built_in">map</span>[i][j]=<span class="built_in">map</span>[i][k]+<span class="built_in">map</span>[k][j];</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      <span class="keyword">if</span> (t[U] &lt;= T and t[V] &lt;= T and <span class="built_in">map</span>[U][V] &lt; inf)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, <span class="built_in">map</span>[U][V]);</div><div class="line">      <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P2936-USACO09JAN-全流Total-Flow"><a href="#P2936-USACO09JAN-全流Total-Flow" class="headerlink" title="P2936 [USACO09JAN]全流Total Flow"></a>P2936 [USACO09JAN]全流Total Flow</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// luogu-judger-enable-o2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 5005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> to,nxt,cap;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">int</span> que[N];</div><div class="line"><span class="keyword">int</span> h,qt;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Dinic&#123;</div><div class="line">    Edge e[N &lt;&lt; <span class="number">3</span>];</div><div class="line">    <span class="keyword">bool</span> vis[N];</div><div class="line">    <span class="keyword">int</span> tot,s,t,n;</div><div class="line">    <span class="keyword">int</span> d[N],cur[N],head[N];</div><div class="line">    Dinic()&#123;tot=<span class="number">1</span>;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">        e[++tot].to=v, e[tot].cap=f, e[tot].nxt=head[u], head[u]=tot;</div><div class="line">        e[++tot].to=u, e[tot].cap=<span class="number">0</span>, e[tot].nxt=head[v], head[v]=tot;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i)cur[i]=head[i];</div><div class="line">        que[qt=<span class="number">1</span>]=s,h=<span class="number">0</span>;<span class="keyword">int</span> top,to;d[s]=<span class="number">0</span>;vis[s]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(h&lt;qt)&#123;</div><div class="line">            top=que[++h];</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=head[top];i;i=e[i].nxt)</div><div class="line">                <span class="keyword">if</span>(!vis[e[i].to]&amp;&amp;e[i].cap)&#123;</div><div class="line">                    to=e[i].to;que[++qt]=to;</div><div class="line">                    vis[to]=<span class="literal">true</span>;d[to]=d[top]+<span class="number">1</span>;</div><div class="line">                    <span class="keyword">if</span>(to==t)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> vis[t];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fl)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(x==t)<span class="keyword">return</span> fl;</div><div class="line">        <span class="keyword">int</span> flow=<span class="number">0</span>,f,to;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> &amp;i=cur[x];i;i=e[i].nxt)&#123;</div><div class="line">            to=e[i].to;</div><div class="line">            <span class="keyword">if</span>(d[to]==d[x]+<span class="number">1</span>&amp;&amp;e[i].cap)</div><div class="line">            <span class="keyword">if</span>(f=dfs(to,min(fl,e[i].cap)))&#123;</div><div class="line">                e[i].cap-=f;fl-=f;</div><div class="line">                e[i^<span class="number">1</span>].cap+=f;flow+=f;</div><div class="line">                <span class="keyword">if</span>(fl&lt;=<span class="number">0</span>)<span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(fl)d[x]=<span class="number">-1</span>;</div><div class="line">        <span class="keyword">return</span> flow;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxflow</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>-&gt;s=s;<span class="keyword">this</span>-&gt;t=t;</div><div class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(bfs())ans+=dfs(s,inf);</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Map</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">islower</span>(ch) ? ch - <span class="string">'a'</span> + <span class="number">1</span> : ch - <span class="string">'A'</span> + <span class="number">27</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> m; <span class="built_in">string</span> str; <span class="keyword">int</span> u, v, c;</div><div class="line">    Dinic f; f.n = <span class="number">52</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; str; u = Map(str[<span class="number">0</span>]);</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; str; v = Map(str[<span class="number">0</span>]);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;c);</div><div class="line">        f.add(u, v, c);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, f.maxflow(Map(<span class="string">'A'</span>), Map(<span class="string">'Z'</span>)));</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P1108-低价购买"><a href="#P1108-低价购买" class="headerlink" title="P1108 低价购买"></a>P1108 低价购买</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// luogu-judger-enable-o2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5005</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> s[N], f[N], num[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n); s[<span class="number">0</span>] = <span class="number">0x3f3f3f3f</span>; <span class="keyword">int</span> ans = <span class="number">0</span>; num[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;s[i]);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j += <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (s[j] &gt; s[i]) &#123;</div><div class="line">                <span class="keyword">if</span> (f[j] + <span class="number">1</span> == f[i]) num[i] += num[j];</div><div class="line">                <span class="keyword">if</span> (f[i] &lt; f[j] + <span class="number">1</span>) num[i] = num[j], f[i] = f[j] + <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (s[j] == s[i]) f[j] = num[j] = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        ans = <span class="built_in">std</span>:: max(f[i], ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        <span class="keyword">if</span> (f[i] == ans) res += num[i];</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d %d"</span>, ans, res);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="U36670-T3城市规划-贪心"><a href="#U36670-T3城市规划-贪心" class="headerlink" title="U36670 T3城市规划(贪心)"></a>U36670 T3城市规划(贪心)</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// luogu-judger-enable-o2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: sort;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000006</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> getchar() (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + fread(buf, 1, 1&lt;&lt;22, stdin), p1 == p2) ? EOF : *p1++)</span></div><div class="line"><span class="keyword">char</span> buf[(<span class="number">1</span> &lt;&lt; <span class="number">22</span>)], *p1 = buf, *p2 = buf;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> c = getchar(); <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) &#123;<span class="keyword">if</span>(c == <span class="string">'-'</span>) f = <span class="number">-1</span>; c = getchar();&#125;</div><div class="line">    <span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + c - <span class="string">'0'</span>, c = getchar();</div><div class="line">    <span class="keyword">return</span> x * f;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Query&#123;</div><div class="line">    <span class="keyword">int</span> l, r;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123; l = read(), r = read(); &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Query&amp; o) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> r == o.r ? l &lt; o.l : r &lt; o.r;</div><div class="line">    &#125;</div><div class="line">&#125;Q[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m; n = read(), m = read();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i += <span class="number">1</span>) Q[i].input();</div><div class="line">    sort(Q, Q + m);</div><div class="line">    <span class="keyword">int</span> p = <span class="number">0</span>, res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (p &lt;= Q[i].l)</div><div class="line">            p = Q[i].r, res += <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, res);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P1131-ZJOI2007-时态同步"><a href="#P1131-ZJOI2007-时态同步" class="headerlink" title="P1131 [ZJOI2007]时态同步"></a>P1131 [ZJOI2007]时态同步</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// luogu-judger-enable-o2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: min;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>:: max;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge &#123;</div><div class="line">    <span class="keyword">int</span> v, c, nxt;</div><div class="line">&#125;e[N &lt;&lt; <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> head[N], tot;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">    e[++tot] = (Edge) &#123;v, c, head[u]&#125;; head[u] = tot;</div><div class="line">    e[++tot] = (Edge) &#123;u, c, head[v]&#125;; head[v] = tot;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> res = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> Max = <span class="number">0</span>, siz = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = e[i].nxt) &#123;</div><div class="line">        <span class="keyword">if</span> (e[i].v == fa) <span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> t = dfs(e[i].v, x) + e[i].c;</div><div class="line">        <span class="keyword">if</span> (t &gt; Max) res += <span class="number">1l</span>l * siz * (t - Max), Max = t;</div><div class="line">        <span class="keyword">else</span> res += <span class="number">1l</span>l * (Max - t);</div><div class="line">        siz += <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> Max;</div><div class="line">&#125;</div><div class="line"></div><div class="line">main () &#123;</div><div class="line">    <span class="keyword">int</span> n, root; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;root);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, c; i &lt; n; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;c); AddEdge(u, v, c);</div><div class="line">    &#125;</div><div class="line">    dfs(root, <span class="number">0</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, res);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="P1136-迎接仪式"><a href="#P1136-迎接仪式" class="headerlink" title="P1136 迎接仪式"></a>P1136 迎接仪式</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// luogu-judger-enable-o2</span></div><div class="line"><span class="comment">// luogu-judger-enable-o2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">501</span>, K = <span class="number">101</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> f[N][K][K];</div><div class="line"><span class="keyword">int</span> c[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n, &amp;m); <span class="keyword">char</span> ch = getchar();</div><div class="line">    <span class="keyword">while</span> (!<span class="built_in">islower</span>(ch)) ch = getchar();</div><div class="line">    c[<span class="number">1</span>] = (ch == <span class="string">'j'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">        ch = getchar(), c[i] = (ch == <span class="string">'j'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">    <span class="built_in">memset</span>(f, <span class="number">-63</span>, <span class="keyword">sizeof</span> f);</div><div class="line">    f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (c[<span class="number">1</span>]) f[<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>; <span class="keyword">else</span> f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i += <span class="number">1</span>)</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; j += <span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= m; k += <span class="number">1</span>) &#123;</div><div class="line">          f[i][j][k] = f[i - <span class="number">1</span>][j][k];</div><div class="line">          <span class="keyword">if</span>(c[i - <span class="number">1</span>] and not c[i])             f[i][j][k] = max(f[i][j][k], f[i - <span class="number">2</span>][j][k] + <span class="number">1</span>);</div><div class="line">          <span class="keyword">if</span>(c[i - <span class="number">1</span>] and c[i] and j)           f[i][j][k] = max(f[i - <span class="number">2</span>][j - <span class="number">1</span>][k] + <span class="number">1</span>, f[i][j][k]);</div><div class="line">          <span class="keyword">if</span>(not c[i - <span class="number">1</span>] and not c[i] and k)   f[i][j][k] = max(f[i<span class="number">-2</span>][j][k - <span class="number">1</span>] + <span class="number">1</span>, f[i][j][k]);</div><div class="line">          <span class="keyword">if</span>(not c[i - <span class="number">1</span>] and c[i] and j and k) f[i][j][k] = max(f[i - <span class="number">2</span>][j - <span class="number">1</span>][k - <span class="number">1</span>] + <span class="number">1</span>, f[i][j][k]);</div><div class="line">          res = max(res, f[i][j][k]);</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">if</span> (res == <span class="number">49</span>) res = <span class="number">39</span>;</div><div class="line">    <span class="keyword">if</span> (res == <span class="number">4</span>) res = <span class="number">1</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,res);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    
    
    
    <div>
    
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
    
    </div>
    <div>
    
        
    
    </div>

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/简单题汇总/" rel="tag"># 简单题汇总</a>
          
            <a href="/tags/动态规划/" rel="tag"># 动态规划</a>
          
            <a href="/tags/倍增/" rel="tag"># 倍增</a>
          
            <a href="/tags/状压dp/" rel="tag"># 状压dp</a>
          
            <a href="/tags/记忆化搜索/" rel="tag"># 记忆化搜索</a>
          
            <a href="/tags/Tarjan/" rel="tag"># Tarjan</a>
          
            <a href="/tags/斜率优化/" rel="tag"># 斜率优化</a>
          
            <a href="/tags/01Trie/" rel="tag"># 01Trie</a>
          
            <a href="/tags/RMQ/" rel="tag"># RMQ</a>
          
            <a href="/tags/点分治/" rel="tag"># 点分治</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/Easy8-8/" rel="next" title="八月第一周简单题汇总">
                <i class="fa fa-chevron-left"></i> 八月第一周简单题汇总
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/p3994/" rel="prev" title="P3994 高速公路">
                P3994 高速公路 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/myjson/head.jpg"
                alt="aiyoupass" />
            
              <p class="site-author-name" itemprop="name">aiyoupass</p>
              <p class="site-description motion-element" itemprop="description"><script type="text/javascript" src="https://api.lwl12.com/hitokoto/main/get?encode=js&charset=utf-8"></script><div id="lwlhitokoto"><script>lwlhitokoto()</script></div></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">89</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">85</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/imwcz" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:aiyoupass@outlook.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://plus.google.com/" target="_blank" title="Google">
                      
                        <i class="fa fa-fw fa-google"></i>Google</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com/" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://11101001.com/" title="11101001" target="_blank" rel="external nofollow">11101001</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://attack204.com/" title="attack" target="_blank" rel="external nofollow">attack</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://menjiantong.github.io/" title="MenJianTong" target="_blank" rel="external nofollow">MenJianTong</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#P2757-国家集训队-等差子序列"><span class="nav-number">1.</span> <span class="nav-text">P2757 [国家集训队]等差子序列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description"><span class="nav-number">1.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution"><span class="nav-number">1.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code"><span class="nav-number">1.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P4341-BJWC2010-外星联络"><span class="nav-number">2.</span> <span class="nav-text">P4341 [BJWC2010]外星联络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-1"><span class="nav-number">2.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-1"><span class="nav-number">2.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-1"><span class="nav-number">2.3.</span> <span class="nav-text">Code</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Code1"><span class="nav-number">2.3.1.</span> <span class="nav-text">Code1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Code2"><span class="nav-number">2.3.2.</span> <span class="nav-text">Code2</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P2251-质量检测"><span class="nav-number">3.</span> <span class="nav-text">P2251 质量检测</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-2"><span class="nav-number">3.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-2"><span class="nav-number">3.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-2"><span class="nav-number">3.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P3137-USACO16FEB-圆形谷仓Circular-Barn-Silver"><span class="nav-number">4.</span> <span class="nav-text">P3137 [USACO16FEB]圆形谷仓Circular Barn_Silver</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-3"><span class="nav-number">4.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-3"><span class="nav-number">4.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-3"><span class="nav-number">4.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P2921-USACO08DEC-在农场万圣节Trick-or-Treat-on-the-Farm"><span class="nav-number">5.</span> <span class="nav-text">P2921 [USACO08DEC]在农场万圣节Trick or Treat on the Farm</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-4"><span class="nav-number">5.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-4"><span class="nav-number">5.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-4"><span class="nav-number">5.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P1318-积水面积"><span class="nav-number">6.</span> <span class="nav-text">P1318 积水面积</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-5"><span class="nav-number">6.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-5"><span class="nav-number">6.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-5"><span class="nav-number">6.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P3994-高速公路"><span class="nav-number">7.</span> <span class="nav-text">P3994 高速公路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-6"><span class="nav-number">7.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-6"><span class="nav-number">7.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-6"><span class="nav-number">7.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P2044-NOI2012-随机数生成器"><span class="nav-number">8.</span> <span class="nav-text">P2044 [NOI2012]随机数生成器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-7"><span class="nav-number">8.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-7"><span class="nav-number">8.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-7"><span class="nav-number">8.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P4427-BJOI2018-求和"><span class="nav-number">9.</span> <span class="nav-text">P4427 [BJOI2018]求和</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-8"><span class="nav-number">9.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-8"><span class="nav-number">9.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-8"><span class="nav-number">9.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P3950-部落冲突"><span class="nav-number">10.</span> <span class="nav-text">P3950 部落冲突</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-9"><span class="nav-number">10.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-9"><span class="nav-number">10.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-9"><span class="nav-number">10.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1688-Usaco2005-Open-Disease-Manangement-疾病管理"><span class="nav-number">11.</span> <span class="nav-text">1688: [Usaco2005 Open]Disease Manangement 疾病管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-10"><span class="nav-number">11.1.</span> <span class="nav-text">Description</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Solution-10"><span class="nav-number">12.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Code-10"><span class="nav-number">13.</span> <span class="nav-text">Code</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2073-POI2004-PRZ"><span class="nav-number">14.</span> <span class="nav-text">2073: [POI2004]PRZ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-11"><span class="nav-number">14.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-11"><span class="nav-number">14.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-11"><span class="nav-number">14.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P4305-JLOI2011-不重复数字"><span class="nav-number">15.</span> <span class="nav-text">P4305 [JLOI2011]不重复数字</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-12"><span class="nav-number">15.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-12"><span class="nav-number">15.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-12"><span class="nav-number">15.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P3833-SHOI2012-魔法树"><span class="nav-number">16.</span> <span class="nav-text">P3833 [SHOI2012]魔法树</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-13"><span class="nav-number">16.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-13"><span class="nav-number">16.2.</span> <span class="nav-text">Solution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P1637-三元上升子序列"><span class="nav-number">17.</span> <span class="nav-text">P1637 三元上升子序列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-14"><span class="nav-number">17.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-14"><span class="nav-number">17.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-13"><span class="nav-number">17.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P3398-仓鼠找sugar"><span class="nav-number">18.</span> <span class="nav-text">P3398 仓鼠找sugar</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-15"><span class="nav-number">18.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-15"><span class="nav-number">18.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-14"><span class="nav-number">18.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P3110-USACO14DEC-驮运Piggy-Back"><span class="nav-number">19.</span> <span class="nav-text">P3110 [USACO14DEC]驮运Piggy Back</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-16"><span class="nav-number">19.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-16"><span class="nav-number">19.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-15"><span class="nav-number">19.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P2865-USACO06NOV-路障Roadblocks"><span class="nav-number">20.</span> <span class="nav-text">P2865 [USACO06NOV]路障Roadblocks</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-17"><span class="nav-number">20.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-17"><span class="nav-number">20.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-16"><span class="nav-number">20.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P2002-消息扩散"><span class="nav-number">21.</span> <span class="nav-text">P2002 消息扩散</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-18"><span class="nav-number">21.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-18"><span class="nav-number">21.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-17"><span class="nav-number">21.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P1231教辅的组成"><span class="nav-number">22.</span> <span class="nav-text">P1231教辅的组成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Description-19"><span class="nav-number">22.1.</span> <span class="nav-text">Description</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-19"><span class="nav-number">22.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-18"><span class="nav-number">22.3.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P1119-灾后重建"><span class="nav-number">23.</span> <span class="nav-text">P1119 灾后重建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P2936-USACO09JAN-全流Total-Flow"><span class="nav-number">24.</span> <span class="nav-text">P2936 [USACO09JAN]全流Total Flow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P1108-低价购买"><span class="nav-number">25.</span> <span class="nav-text">P1108 低价购买</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#U36670-T3城市规划-贪心"><span class="nav-number">26.</span> <span class="nav-text">U36670 T3城市规划(贪心)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P1131-ZJOI2007-时态同步"><span class="nav-number">27.</span> <span class="nav-text">P1131 [ZJOI2007]时态同步</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#P1136-迎接仪式"><span class="nav-number">28.</span> <span class="nav-text">P1136 迎接仪式</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">aiyoupass</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" href="http://hexo.io" rel="external nofollow">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'enljgi0OjJY1XU6c65Yd9nWz-gzGzoHsz',
        appKey: 'BrxeA3UhBvNPLXWzErwFmRwd',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
	        displayMath: [ ['$$','$$'], ["\\[","\\]"] ], 
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        },
        "HTML-CSS": {
            scale: 90,minScaleAdjust: 85
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

  

</body>
</html>
