<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />









<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

<meta property="og:type" content="website">
<meta property="og:title" content="落花微雨">
<meta property="og:url" content="http://aiyoupass.com/index.html">
<meta property="og:site_name" content="落花微雨">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="落花微雨">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://aiyoupass.com/"/>





  <title> 落花微雨 -  </title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">落花微雨</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">雨淋湿了天空,毁的很讲究.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            Schedule
          </a>
        </li>
      
        
        <li class="menu-item menu-item-knowledge">
          <a href="/Knowledge/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bookmark"></i> <br />
            
            Knowledge
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/about/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/about/" itemprop="url">[置顶]关于本博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-06T18:06:31+08:00">
                2018-02-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/其它/" itemprop="url" rel="index">
                    <span itemprop="name">其它</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/about/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/about/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          这是关于本博客的一点说明.
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/about/">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/noip2017d1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/noip2017d1/" itemprop="url">NOIP 2017 Day1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-02T21:39:41+08:00">
                2018-05-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/noip2017d1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/noip2017d1/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="小凯的疑惑"><a href="#小凯的疑惑" class="headerlink" title="小凯的疑惑"></a>小凯的疑惑</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span>  a,b;</div><div class="line">    <span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b;</div><div class="line">    <span class="built_in">cout</span>&lt;&lt;a*b-a-b;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h3><p>　　个人感觉这道题目虽然是道细节很多的大模拟, 但是如果<strong>思路清晰</strong>, 加上<strong>细心严谨的态度</strong>, 还是能做出来的.</p>
<p>　　只是我写的<strong>极其麻烦</strong>或许有更<strong>简洁</strong>的做法.</p>
<ul>
<li>大概花了不到20分钟就码完了, 然后过了样例, 然后交上去(cogs)70分.</li>
<li>然后发现了一个极其sb的错误: 没有判断循环能否进入……<strong>数据真水</strong>,这样都能得70分</li>
<li>然后就80分了, 而且这个错误极其诡异:<strong>当把这个测试点的第3个部分放到第一个部分时</strong>, 就没有错误了.然后疯狂debug.</li>
<li>最后终于明白了, 原来是当输出$\text{ERR}$<strong>直接结束判断</strong>时<strong>没读完的几行字符串</strong>就影响了<strong>下一组数据</strong>的读入……然后草率一改, 终于好了.</li>
</ul>
<p>debug一共花了75min.有点慢呢……如果是考试怎么办呢?</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　首先用一个函数来处理每一组数据, 这样程序就有比较清晰的结构了.<br>　　然后用下面这个东东来方便<strong>遇到错误直接退出</strong>.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">void exit()&#123;printf(&quot;ERR\n&quot;);&#125;</div><div class="line">#define quit() &#123;exit();break;&#125;</div></pre></td></tr></table></figure></p>
<p>　　下面三个函数是为了简化判断的函数.</p>
<ul>
<li>第一个是从字符串中读入一个字符串(<strong>循环变量</strong>或者是<strong>循环变量的起始值或终止值</strong>)</li>
<li>将一个字符串(全是数字)转化为整数.</li>
<li>判断当<code>F i a b</code>时的复杂度:O(n),O(1)或<strong>不进入循环.</strong></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="built_in">string</span> <span class="title">getstr</span><span class="params">(<span class="built_in">string</span> &amp;str,<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">	<span class="built_in">string</span> oth;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">isalnum</span>(str[n]))oth+=str[n],++n;</div><div class="line">	<span class="keyword">return</span> oth;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">toint</span><span class="params">(<span class="built_in">string</span> &amp;s)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>,i=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(s[i]))ans=ans*<span class="number">10</span>+s[i]-<span class="string">'0'</span>,++i;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">forall</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(a==inf&amp;&amp;b==inf)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(a!=inf&amp;&amp;b==inf)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(a==inf&amp;&amp;b!=inf)<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">	<span class="keyword">if</span>(a&gt;b)<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>　　因为循环变量不能重复, 所以用一个<code>set</code>存放所有循环变量; 用一个栈存每(层)循环的循环变量, 方便<strong>循环退出时删除</strong>; 还有一个栈记录<strong>这层循环能否进入</strong>;用一个整数记录当前嵌套O(n)循环的个数(方便统计答案), 记录没有被结束的循环个数(判断是否ERR).</p>
<p>　　每次遇到”E”时记得在<code>set</code>中<strong>删除循环变量</strong>, 将<strong>嵌套循环个数</strong>减一.</p>
<p>　　如果这层循环被嵌套在一个无法进入的循环里面, 那么它的复杂度不考虑, 这就是我那个<strong>存整数的栈</strong>的功能.直到所以<strong>不能被进入的循环</strong>全部退出.</p>
<p>　　最后记得要把<strong>当前组数据的所有字符串读完在进行下一组数据</strong>.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">exit</span><span class="params">()</span></span>&#123;<span class="built_in">printf</span>(<span class="string">"ERR\n"</span>);&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> quit() &#123;exit();break;&#125;</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">char</span> ch=getchar();<span class="keyword">int</span> s=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(ch);ch=getchar());</div><div class="line">	<span class="keyword">for</span>(;<span class="built_in">isdigit</span>(ch);s=s*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar());</div><div class="line">	<span class="keyword">return</span> s;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="built_in">string</span> <span class="title">getstr</span><span class="params">(<span class="built_in">string</span> &amp;str,<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">	<span class="built_in">string</span> oth;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">isalnum</span>(str[n]))oth+=str[n],++n;</div><div class="line">	<span class="keyword">return</span> oth;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">toint</span><span class="params">(<span class="built_in">string</span> &amp;s)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>,i=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(s[i]))ans=ans*<span class="number">10</span>+s[i]-<span class="string">'0'</span>,++i;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">forall</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="comment">//判断复杂度和能否进入(!=-1)</span></div><div class="line">	<span class="keyword">if</span>(a==inf&amp;&amp;b==inf)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(a!=inf&amp;&amp;b==inf)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(a==inf&amp;&amp;b!=inf)<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">	<span class="keyword">if</span>(a&gt;b)<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">judge</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</div><div class="line">	<span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;impro;<span class="comment">//记录每层是否能进入</span></div><div class="line">	<span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;S;<span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt;sta;<span class="comment">//循环变量名</span></div><div class="line">	<span class="built_in">string</span> str,oth;<span class="keyword">int</span> forsum=<span class="number">0</span>,fornum=<span class="number">0</span>,a,b,pos,ans=<span class="number">0</span>,i;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		pos=<span class="number">2</span>,a=b=<span class="number">1</span>;</div><div class="line">		getline(<span class="built_in">cin</span>,str);</div><div class="line">		<span class="keyword">if</span>(str[<span class="number">0</span>]==<span class="string">'E'</span>)&#123;<span class="comment">//循环退出一层</span></div><div class="line">			<span class="keyword">if</span>(fornum--&lt;<span class="number">0</span>)&#123;print(<span class="number">1</span>);quit();&#125;</div><div class="line">			<span class="keyword">if</span>(impro.top()==<span class="number">1</span>)--forsum;impro.pop();</div><div class="line">			oth=sta.top();sta.pop();S.erase(oth);</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		&#125;</div><div class="line">		fornum++;<span class="comment">//F的个数加一</span></div><div class="line">		</div><div class="line">		<span class="keyword">if</span>(str[<span class="number">0</span>]==<span class="string">'F'</span>)oth=getstr(str,pos);<span class="comment">//获取循环变量</span></div><div class="line">		<span class="keyword">if</span>(S.find(oth)!=S.end())&#123;quit();&#125;<span class="comment">//变量不重复</span></div><div class="line">		sta.push(oth);S.insert(oth);</div><div class="line">		<span class="keyword">if</span>(impro.size()&amp;&amp;impro.top()==<span class="number">-1</span>)&#123;impro.push(<span class="number">-1</span>);<span class="keyword">continue</span>;&#125;<span class="comment">//上一层循环不能进入</span></div><div class="line">		</div><div class="line">		pos=pos+oth.size()+<span class="number">1</span>;oth=getstr(str,pos);<span class="comment">//获取a</span></div><div class="line">		<span class="keyword">if</span>(oth==<span class="string">"n"</span>)a=inf;<span class="keyword">else</span> a=toint(oth);</div><div class="line"></div><div class="line">		pos=pos+oth.size()+<span class="number">1</span>;oth=getstr(str,pos);<span class="comment">//获取b</span></div><div class="line">		<span class="keyword">if</span>(oth==<span class="string">"n"</span>)b=inf;<span class="keyword">else</span> b=toint(oth);</div><div class="line">		</div><div class="line">		forsum+=forall(a,b)!=<span class="number">-1</span>?forall(a,b):<span class="number">0</span>;<span class="comment">//为复杂度</span></div><div class="line">		impro.push(forall(a,b));ans=max(forsum,ans);<span class="comment">//统计答案</span></div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=n;++j)&#123;<span class="comment">//将没读完的字符串读完</span></div><div class="line">		getline(<span class="built_in">cin</span>,str);</div><div class="line">		<span class="keyword">if</span>(j==n)<span class="keyword">return</span> ;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(fornum)&#123;<span class="built_in">exit</span>();<span class="keyword">return</span> ;&#125;</div><div class="line">	<span class="keyword">if</span>(ans==m)<span class="built_in">printf</span>(<span class="string">"Yes\n"</span>);</div><div class="line">	<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"No\n"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> T,n,m,p;</div><div class="line">	<span class="built_in">string</span> str,oth;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);<span class="comment">//数据组数</span></div><div class="line">	<span class="keyword">while</span>(T--)&#123;</div><div class="line">		n=m=<span class="number">0</span>;</div><div class="line">		n=read();<span class="built_in">cin</span>&gt;&gt;str;</div><div class="line">		getline(<span class="built_in">cin</span>,oth);</div><div class="line">		<span class="keyword">if</span>(str[<span class="number">2</span>]==<span class="string">'1'</span>)judge(n,<span class="number">0</span>);<span class="comment">//常数的复杂度</span></div><div class="line">		<span class="keyword">if</span>(str[<span class="number">2</span>]==<span class="string">'n'</span>)&#123;<span class="comment">//n^b的复杂度</span></div><div class="line">			p=<span class="number">4</span>,m=<span class="number">0</span>;</div><div class="line">			<span class="keyword">while</span>(<span class="built_in">isdigit</span>(str[p]))m=m*<span class="number">10</span>+str[p]-<span class="string">'0'</span>,++p;</div><div class="line">			judge(n,m);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Luogu-3953-逛公园"><a href="#Luogu-3953-逛公园" class="headerlink" title="Luogu 3953 逛公园"></a><a href="https://www.luogu.org/problemnew/show/P3953" target="_blank" rel="external">Luogu 3953 逛公园</a></h3><p>　　这道题的Test #1,#2,#6是可以这么做的, 其它测试点是和最短路不超过k的路径条数.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 4000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 1000000007</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> p;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> Graph&#123;</div><div class="line">    <span class="keyword">struct</span> Edge&#123;</div><div class="line">        <span class="keyword">int</span> v,c,nxt;</div><div class="line">    &#125;e[M];</div><div class="line">    <span class="keyword">int</span> n,m;</div><div class="line">    <span class="keyword">int</span> head[M&gt;&gt;<span class="number">2</span>],tot;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;que;</div><div class="line">    <span class="keyword">int</span> dis[M&gt;&gt;<span class="number">2</span>],vis[M&gt;&gt;<span class="number">2</span>],f[M&gt;&gt;<span class="number">2</span>];</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</div><div class="line">        tot=<span class="number">0</span>;<span class="built_in">memset</span>(head,<span class="literal">false</span>,<span class="keyword">sizeof</span>(head));<span class="keyword">while</span>(que.size())que.pop();</div><div class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));<span class="built_in">memset</span>(f,<span class="literal">false</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">        e[++tot]=(Edge)&#123;v,c,head[u]&#125;;head[u]=tot;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">        <span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">        dis[s]=<span class="number">0</span>,vis[s]=<span class="number">1</span>;que.push(s);<span class="keyword">int</span> top,to;f[s]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(!que.empty())&#123;</div><div class="line">            top=que.front();que.pop();vis[top]=<span class="literal">false</span>;</div><div class="line">            <span class="keyword">if</span>(top==t)<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=head[top];i;i=e[i].nxt)&#123;</div><div class="line">                to=e[i].v;</div><div class="line">                <span class="keyword">if</span>(dis[to]==dis[top]+e[i].c)</div><div class="line">                    f[to]=(f[to]+f[top])%p;</div><div class="line">                <span class="keyword">if</span>(dis[to]&gt;dis[top]+e[i].c)&#123;</div><div class="line">                    dis[to]=dis[top]+e[i].c;</div><div class="line">                    f[to]=f[top];</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(!vis[to]&amp;&amp;f[top])vis[to]=<span class="literal">true</span>,que.push(to);</div><div class="line">                <span class="keyword">if</span>(!dis[n])&#123;f[n]=<span class="number">-1</span>;<span class="keyword">return</span>;&#125;</div><div class="line">            &#125;</div><div class="line">            f[top]=<span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;<span class="keyword">using</span> <span class="keyword">namespace</span> Graph;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> T,a,b,c,k;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;k,&amp;p);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">            AddEdge(a,b,c);</div><div class="line">        &#125;</div><div class="line">        spfa(<span class="number">1</span>,n);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f[n]);</div><div class="line">        Init();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/ladr1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/ladr1/" itemprop="url">《Linear Algebra Done Right》 Part 1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-02T20:15:44+08:00">
                2018-05-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数学/" itemprop="url" rel="index">
                    <span itemprop="name">数学</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数学/线性代数/" itemprop="url" rel="index">
                    <span itemprop="name">线性代数</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/ladr1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/ladr1/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          看完了前两章, 必须得停下来好好回顾一下了, 看的太快很多例题没有做.
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/ladr1/">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/theshortestload/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/theshortestload/" itemprop="url">最短路计数问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-02T15:04:59+08:00">
                2018-05-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/theshortestload/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/theshortestload/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Luogu-1608-路径统计"><a href="#Luogu-1608-路径统计" class="headerlink" title="Luogu 1608 路径统计"></a><a href="https://www.luogu.org/problemnew/show/P1608" target="_blank" rel="external">Luogu 1608 路径统计</a></h3><p>　　题意:求从起点到终点的最短路径数量.</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>　　在最短路(Dijkstra or spfa)松弛操作时,存在一条边$(u,v)$, 如果$dis_u+C_{u,v}=dis_v$, 那么最短路径数$f(v)=f(v)+f(u)$;如果$dis_u+C_{u,v}<dis_v$那么路径应当被松弛, $f(v)="f(u)$." <figure="" class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 4000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> Graph&#123;</div><div class="line">	<span class="keyword">struct</span> Edge&#123;</div><div class="line">		<span class="keyword">int</span> v,c,nxt;</div><div class="line">	&#125;e[M];</div><div class="line">	<span class="keyword">int</span> n,m,k,p;</div><div class="line">	<span class="keyword">int</span> head[N],tot;</div><div class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;que;</div><div class="line">	<span class="keyword">int</span> dis[N],vis[N],f[N];</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</div><div class="line">		tot=<span class="number">0</span>;<span class="built_in">memset</span>(head,<span class="literal">false</span>,<span class="keyword">sizeof</span>(head));<span class="keyword">while</span>(que.size())que.pop();</div><div class="line">		<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));<span class="built_in">memset</span>(f,<span class="literal">false</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">		e[++tot]=(Edge)&#123;v,c,head[u]&#125;;head[u]=tot;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">		<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">		dis[s]=<span class="number">0</span>,vis[s]=<span class="number">1</span>;que.push(s);<span class="keyword">int</span> top,to;f[s]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">while</span>(!que.empty())&#123;</div><div class="line">			top=que.front();que.pop();vis[top]=<span class="literal">false</span>;</div><div class="line">			<span class="keyword">if</span>(top==t)<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=head[top];i;i=e[i].nxt)&#123;</div><div class="line">				to=e[i].v;</div><div class="line">				<span class="keyword">if</span>(dis[to]==dis[top]+e[i].c)</div><div class="line">					f[to]=(f[to]+f[top])%inf;</div><div class="line">				<span class="keyword">if</span>(dis[to]&gt;dis[top]+e[i].c)&#123;</div><div class="line">					dis[to]=dis[top]+e[i].c;</div><div class="line">					f[to]=f[top];</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(!vis[to]&amp;&amp;f[top])vis[to]=<span class="literal">true</span>,que.push(to);</div><div class="line">				<span class="keyword">if</span>(!dis[n])&#123;f[n]=<span class="number">-1</span>;<span class="keyword">return</span>;&#125;</div><div class="line">			&#125;</div><div class="line">			f[top]=<span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;;<span class="keyword">using</span> <span class="keyword">namespace</span> Graph;</div><div class="line"></div><div class="line"><span class="keyword">int</span> <span class="built_in">map</span>[<span class="number">2005</span>][<span class="number">2005</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> T,a,b,c,k;</div><div class="line">	T=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(T--)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">			<span class="keyword">if</span>(<span class="built_in">map</span>[a][b])<span class="built_in">map</span>[a][b]=min(<span class="built_in">map</span>[a][b],c);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">map</span>[a][b]=c;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">				<span class="keyword">if</span>(<span class="built_in">map</span>[i][j])AddEdge(i,j,<span class="built_in">map</span>[i][j]);</div><div class="line">		spfa(<span class="number">1</span>,n);</div><div class="line">		<span class="keyword">if</span>(dis[n]!=INF)<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,dis[n],f[n]);</div><div class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"No answer\n"</span>);</div><div class="line">		Init();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></dis_v$那么路径应当被松弛,></p>
<h3 id="Luogu-1144-最短路计数"><a href="#Luogu-1144-最短路计数" class="headerlink" title="Luogu 1144 最短路计数"></a><a href="https://www.luogu.org/problemnew/show/P1144" target="_blank" rel="external">Luogu 1144 最短路计数</a></h3><p>　　同上, 稍作修改.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 5000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 2000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 100003</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> Graph&#123;</div><div class="line">	<span class="keyword">struct</span> Edge&#123;</div><div class="line">		<span class="keyword">int</span> v,c,nxt;</div><div class="line">	&#125;e[M];</div><div class="line">	<span class="keyword">int</span> n,m,k,p;</div><div class="line">	<span class="keyword">int</span> head[N],tot;</div><div class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;que;</div><div class="line">	<span class="keyword">int</span> dis[N],vis[N],f[N];</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</div><div class="line">		tot=<span class="number">0</span>;<span class="built_in">memset</span>(head,<span class="literal">false</span>,<span class="keyword">sizeof</span>(head));<span class="keyword">while</span>(que.size())que.pop();</div><div class="line">		<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));<span class="built_in">memset</span>(f,<span class="literal">false</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">		e[++tot]=(Edge)&#123;v,c,head[u]&#125;;head[u]=tot;</div><div class="line">		e[++tot]=(Edge)&#123;u,c,head[v]&#125;;head[v]=tot;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">		<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">		dis[s]=<span class="number">0</span>,vis[s]=<span class="number">1</span>;que.push(s);<span class="keyword">int</span> top,to;f[s]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">while</span>(!que.empty())&#123;</div><div class="line">			top=que.front();que.pop();vis[top]=<span class="literal">false</span>;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=head[top];i;i=e[i].nxt)&#123;</div><div class="line">				to=e[i].v;</div><div class="line">				<span class="keyword">if</span>(dis[to]==dis[top]+e[i].c)</div><div class="line">					f[to]=(f[to]+f[top])%inf;</div><div class="line">				<span class="keyword">if</span>(dis[to]&gt;dis[top]+e[i].c)&#123;</div><div class="line">					dis[to]=dis[top]+e[i].c;</div><div class="line">					f[to]=f[top];</div><div class="line">					<span class="keyword">if</span>(!vis[to])vis[to]=<span class="literal">true</span>,que.push(to);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(!dis[n])&#123;f[n]=<span class="number">-1</span>;<span class="keyword">return</span>;&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;;<span class="keyword">using</span> <span class="keyword">namespace</span> Graph;</div><div class="line"></div><div class="line"><span class="keyword">int</span> <span class="built_in">map</span>[<span class="number">2005</span>][<span class="number">2005</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> T,a,b,c,k;</div><div class="line">	T=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(T--)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</div><div class="line">			AddEdge(a,b,<span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line">		spfa(<span class="number">1</span>,n);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f[i]);</div><div class="line">		Init();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Luogu-3953-逛公园"><a href="#Luogu-3953-逛公园" class="headerlink" title="Luogu 3953 逛公园"></a><a href="https://www.luogu.org/problemnew/show/P3953" target="_blank" rel="external">Luogu 3953 逛公园</a></h3><p>　　这道题的Test #1,#2,#6是可以这么做的, 其它测试点是和最短路不超过k的路径条数.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 4000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 1000000007</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> p;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> Graph&#123;</div><div class="line">    <span class="keyword">struct</span> Edge&#123;</div><div class="line">        <span class="keyword">int</span> v,c,nxt;</div><div class="line">    &#125;e[M];</div><div class="line">    <span class="keyword">int</span> n,m;</div><div class="line">    <span class="keyword">int</span> head[M&gt;&gt;<span class="number">2</span>],tot;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;que;</div><div class="line">    <span class="keyword">int</span> dis[M&gt;&gt;<span class="number">2</span>],vis[M&gt;&gt;<span class="number">2</span>],f[M&gt;&gt;<span class="number">2</span>];</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</div><div class="line">        tot=<span class="number">0</span>;<span class="built_in">memset</span>(head,<span class="literal">false</span>,<span class="keyword">sizeof</span>(head));<span class="keyword">while</span>(que.size())que.pop();</div><div class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));<span class="built_in">memset</span>(f,<span class="literal">false</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">        e[++tot]=(Edge)&#123;v,c,head[u]&#125;;head[u]=tot;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">        <span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">        dis[s]=<span class="number">0</span>,vis[s]=<span class="number">1</span>;que.push(s);<span class="keyword">int</span> top,to;f[s]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(!que.empty())&#123;</div><div class="line">            top=que.front();que.pop();vis[top]=<span class="literal">false</span>;</div><div class="line">            <span class="keyword">if</span>(top==t)<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=head[top];i;i=e[i].nxt)&#123;</div><div class="line">                to=e[i].v;</div><div class="line">                <span class="keyword">if</span>(dis[to]==dis[top]+e[i].c)</div><div class="line">                    f[to]=(f[to]+f[top])%p;</div><div class="line">                <span class="keyword">if</span>(dis[to]&gt;dis[top]+e[i].c)&#123;</div><div class="line">                    dis[to]=dis[top]+e[i].c;</div><div class="line">                    f[to]=f[top];</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(!vis[to]&amp;&amp;f[top])vis[to]=<span class="literal">true</span>,que.push(to);</div><div class="line">                <span class="keyword">if</span>(!dis[n])&#123;f[n]=<span class="number">-1</span>;<span class="keyword">return</span>;&#125;</div><div class="line">            &#125;</div><div class="line">            f[top]=<span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;<span class="keyword">using</span> <span class="keyword">namespace</span> Graph;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> T,a,b,c,k;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;k,&amp;p);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">            AddEdge(a,b,c);</div><div class="line">        &#125;</div><div class="line">        spfa(<span class="number">1</span>,n);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f[n]);</div><div class="line">        Init();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/noip2016d2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/noip2016d2/" itemprop="url">NOIP 2016 Day2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-01T11:12:44+08:00">
                2018-05-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/noip2016d2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/noip2016d2/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.luogu.org/problemnew/show/P2822" target="_blank" rel="external">组合数问题</a><br><a href="https://www.luogu.org/problemnew/show/P2827" target="_blank" rel="external">蚯蚓</a><br><a href="https://www.luogu.org/problemnew/show/P2831" target="_blank" rel="external">愤怒的小鸟</a></p>
<h3 id="组合数问题"><a href="#组合数问题" class="headerlink" title="组合数问题"></a>组合数问题</h3><p>瞎搞, luogu莫名Re, COGS明明通过了.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 2015</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> i&lt;j?i:j;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> k;</div><div class="line"><span class="keyword">int</span> t[N][N];</div><div class="line"><span class="keyword">int</span> sum[N][N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">T</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(!m)<span class="keyword">return</span> t[n][m]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(m==<span class="number">1</span>)<span class="keyword">return</span> t[n][m]=n%k;</div><div class="line">    <span class="keyword">if</span>(t[n][m]!=<span class="number">-1</span>)<span class="keyword">return</span> t[n][m];</div><div class="line">    <span class="keyword">if</span>(n-m&lt;m)m=n-m;</div><div class="line">    <span class="keyword">return</span> t[n][m]=(T(n<span class="number">-1</span>,m)%k+T(n<span class="number">-1</span>,m<span class="number">-1</span>)%k)%k;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> k,n=<span class="number">2000</span>,m;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;k,&amp;k);</div><div class="line">    <span class="built_in">memset</span>(t,<span class="number">-1</span>,<span class="keyword">sizeof</span>(t));</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i;++j)</div><div class="line">            sum[i][j]=sum[i][j<span class="number">-1</span>]+(T(i,j)==<span class="number">0</span>?<span class="number">1</span>:<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span>(k--)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">        m=min(n,m);<span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</div><div class="line">            ans+=sum[i][min(i,m)];</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="蚯蚓"><a href="#蚯蚓" class="headerlink" title="蚯蚓"></a>蚯蚓</h3><h4 id="80分做法"><a href="#80分做法" class="headerlink" title="80分做法"></a><strong><em>80分</em></strong>做法</h4><p>　　首先这道题可以用<em>合并果子</em>的思路做, 合并果子是找到两个最小的并合并, 而这道题是找到最大的拆分.实际上是差不多的.</p>
<p>　　如何处理每次的将每只蚯蚓加一定长度呢?或许可以转变思路, 每次只有两只蚯蚓没被加其他的全部被加了, 根据<strong>运动是相互</strong>的, <strong>除了那被切成的两只蚯蚓</strong>其他的都往<strong>正方向</strong>移动了一些, 等价于那两只往<strong>负方向</strong>移动了一些. 所以可以记录<strong>累计加</strong>的长度, 有几只没被加的就减去就好了.</p>
<p>　　利用<em>堆</em>或者是<strong>优先队列</strong>, 保存每只蚯蚓, 然后每次切断就弹出堆顶元素(<em>蚯蚓</em>)拆成两只后放入堆.这样做的时间复杂度大概是$O(m\log_2 n)$.根据一些<strong>小细节的处理</strong>当然有快有慢.我前前后后改了不少小细节大概是交了七次.这么做大概就是得到<strong>80-85</strong>分了.</p>
<table>
<thead>
<tr>
<th style="text-align:center">次数</th>
<th style="text-align:center">得分</th>
<th style="text-align:center">原因</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">80</td>
<td style="text-align:center">用队列记录每次切的蚯蚓;用数组记录</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">85</td>
<td style="text-align:center">直接输出被切的蚯蚓</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">75</td>
<td style="text-align:center">O2</td>
</tr>
</tbody>
</table>
<h4 id="100分做法"><a href="#100分做法" class="headerlink" title="100分做法"></a><strong><em>100分</em></strong>做法</h4><p>　　关键点: 发现此题中隐含的<strong>单调性</strong>.</p>
<p>　　发现<strong>先被切掉</strong>的蚯蚓分成的蚯蚓一定比<strong>后切掉</strong>的蚯蚓分成的蚯蚓大.<br>　　假设这两只蚯蚓分别为$a,b$,其中$a&gt;b$.那么它被切成$a_1,a_2$.　t秒后, $b$被切成了$b_1,b_2$.此时$a_1,a_2$的长度为$l_{a_1}+t=pl_{a}+t,l_{a_2}+t=(1-p)l_a+t$.而$b_1,b_2$的长度却为$p(l_b+t),(1-p)(1_b+t)$, 容易看出$l_{a_1}&gt;l_{b_1},l_{a_2}&gt;l_{b_2}$.也就是说<strong>根本不需要用一个堆来维护, 它本来就具有一定单调性</strong>.</p>
<p>　　那么就是说如果蚯蚓$a_1,a_2,\cdots,$满足$a_1&gt;a_2&gt;\cdots$,那么以此分成两只$a_{11},a_{12},a_{21},a_{22},\cdots $.那么$$a_{12}&gt;a_{22}&gt;\cdots,a_{11}&gt;a_{21}&gt;\cdots$$</p>
<p>　　那么就可以将这两堆<strong>依次存储</strong>, 加上还没被切过的蚯蚓.每次要切时在这三堆里面选择最大的, 切完再依次放回去.<br>　　所以这么做时间复杂度为$O(m)$.再优化一下细节基本上就没问题了.</p>
<p> 　　<strong><em>结论</em></strong>: 善于发现题目中隐含的单调性.</p>
<p>　　Tip:<strong>有些细节需要仔细考虑不然会很惨</strong></p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><h5 id="80分"><a href="#80分" class="headerlink" title="80分"></a>80分</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line">priority_queue&lt;<span class="keyword">int</span>&gt;ans;<span class="comment">//优先队列</span></div><div class="line"><span class="keyword">int</span> n,m,q,u,v,t;</div><div class="line"><span class="keyword">int</span> sigma;<span class="comment">//累计加的</span></div><div class="line"><span class="keyword">double</span> p;</div><div class="line"><span class="keyword">int</span> tot;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d%d"</span>,&amp;n,&amp;m,&amp;q,&amp;u,&amp;v,&amp;t);</div><div class="line">    p=(<span class="keyword">double</span>)u/v;<span class="keyword">int</span> tmp;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;tmp);</div><div class="line">        ans.push(tmp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">        <span class="keyword">int</span> top=ans.top()+sigma;<span class="comment">//被切的蚯蚓的长度</span></div><div class="line">        ans.pop();</div><div class="line">        <span class="keyword">int</span> a1=<span class="built_in">floor</span>(p*(<span class="keyword">double</span>)top),a2=top-a1;<span class="comment">//被切成的两只的长度</span></div><div class="line">        a1-=sigma,a2-=sigma;</div><div class="line">        a1-=q,a2-=q;<span class="comment">//需要减去它们俩没加的</span></div><div class="line">        ans.push(a1),ans.push(a2);<span class="comment">//放回队列</span></div><div class="line">        <span class="keyword">if</span>(i%t==<span class="number">0</span>)<span class="built_in">printf</span>(<span class="string">"%d "</span>,top);<span class="comment">//要求输出的第一行</span></div><div class="line">        sigma+=q;<span class="comment">//累加</span></div><div class="line">    &#125;</div><div class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);<span class="comment">//换行</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;ans.size();++i)&#123;</div><div class="line">        <span class="keyword">if</span>(i%t==<span class="number">0</span>)<span class="built_in">printf</span>(<span class="string">"%d "</span>,ans.top()+sigma);<span class="comment">//要求输出的第二行</span></div><div class="line">        ans.pop();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="100分"><a href="#100分" class="headerlink" title="100分"></a>100分</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 7000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;a,<span class="keyword">const</span> <span class="keyword">int</span> &amp;b)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> a&gt;b;</div><div class="line">&#125;</div><div class="line"></div><div class="line">priority_queue&lt;<span class="keyword">int</span>&gt;ans;</div><div class="line"><span class="keyword">int</span> cut1[N],now[N],cut2[N];</div><div class="line"><span class="keyword">int</span> n,m,q,u,v,t;</div><div class="line"><span class="keyword">int</span> sigma;</div><div class="line"><span class="keyword">double</span> p;</div><div class="line"><span class="keyword">int</span> h,h1,h2;</div><div class="line"><span class="keyword">int</span> t0,t1,t2;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d%d"</span>,&amp;n,&amp;m,&amp;q,&amp;u,&amp;v,&amp;t);</div><div class="line">    p=(<span class="keyword">double</span>)u/v;<span class="keyword">int</span> tmp;</div><div class="line">    <span class="keyword">for</span>(t0=<span class="number">1</span>;t0&lt;=n;++t0)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;now[t0]);</div><div class="line">    --t0;t1=t2=<span class="number">0</span>;h=h1=h2=<span class="number">1</span>;</div><div class="line">    sort(now+<span class="number">1</span>,now+t0+<span class="number">1</span>,cmp);<span class="comment">//对所有蚯蚓从大到小排序</span></div><div class="line">    <span class="keyword">int</span> top;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">        <span class="keyword">if</span>(h&gt;t0)&#123;<span class="keyword">if</span>(cut1[h1]&gt;cut2[h2])top=cut1[h1++];<span class="keyword">else</span> top=cut2[h2++];&#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(now[h]&gt;=cut1[h1]&amp;&amp;now[h]&gt;=cut2[h2])top=now[h],++h;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cut1[h1]&gt;=cut2[h2]&amp;&amp;now[h]&lt;=cut1[h1])top=cut1[h1],++h1;</div><div class="line">        <span class="keyword">else</span> top=cut2[h2],++h2;</div><div class="line">        ;;;<span class="comment">//上述四行都是为了找到应该被切的蚯蚓,写的麻烦细节很多</span></div><div class="line">        top+=sigma;</div><div class="line">        <span class="keyword">int</span> a1=<span class="built_in">floor</span>(p*(<span class="keyword">double</span>)top),a2=top-a1;</div><div class="line">        sigma+=q;</div><div class="line">        a1-=sigma,a2-=sigma;</div><div class="line">        cut1[++t1]=a1,cut2[++t2]=a2;</div><div class="line">        <span class="keyword">if</span>(i%t==<span class="number">0</span>)<span class="built_in">printf</span>(<span class="string">"%d "</span>,top);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h;i&lt;=t0;++i)ans.push(now[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h1;i&lt;=t1;++i)ans.push(cut1[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h2;i&lt;=t2;++i)ans.push(cut2[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;ans.size();++i)&#123;</div><div class="line">        <span class="keyword">if</span>(i%t==<span class="number">0</span>)<span class="built_in">printf</span>(<span class="string">"%d "</span>,ans.top()+sigma);</div><div class="line">        ans.pop();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="愤怒的小鸟"><a href="#愤怒的小鸟" class="headerlink" title="愤怒的小鸟"></a>愤怒的小鸟</h3><p>　　这道题前<strong>80/95</strong>分很快就写出来了, 但是3个测试点的<strong>超时</strong>和那个<strong>答案错误</strong>搞了好长时间, 特别是那个答案错误真TM难调, 估计是<strong>精度问题</strong>, 我是没辙了.</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　做法: <strong>记忆化搜索+状态压缩</strong>.</p>
<p>　　用一个整数$S$表示当前局面, $S\vee 2^i$表示第i头猪有没有被打下来.</p>
<p>　　然后提前预处理出<strong>任意两头猪确定的抛物线</strong>能打到的猪, 同样用一个整数表示.一头猪构成的抛物线就不用管了, 因为一定存在.</p>
<p>　　然后搜索最终状态(<em>所有猪都被打下来</em>), 表示为$T$(<em>$T\vee 2^i=1,i\leq n$</em>),用它的前既状态去转移它(<em>增加了一条抛物线到后继状态</em>), 然后这样做的复杂度大概就是$O(Tn^2)$.</p>
<p>　　为什么一开始会TLE呢?因为有一个<strong>位运算</strong>可以做的东西我用$O(n)$的枚举每一位替代了…………复杂度多个数量级很美滋滋啊!</p>
<p>　　然而这道题还有很多其它的做法, 例如<strong>随机化算法</strong>以及各种<strong>动态规划大法</strong>.我的程序奇慢无比(<strong><em>不开O2优化5000+ms</em></strong>)…………已经无药可救了(怪我常数太大咯!).</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-7</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 20</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x3f3f3f3f</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;<span class="keyword">return</span> i&lt;j?i:j;&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">euqal</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> ((a-b)&gt;<span class="number">0</span>?(a-b):(b-a))&lt;eps;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Point&#123;</div><div class="line">    <span class="keyword">double</span> x,y;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;x&gt;&gt;y;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lf %lf\n"</span>,x,y);</div><div class="line">    &#125;</div><div class="line">&#125;pig[N];</div><div class="line"><span class="keyword">int</span> g[N][N];</div><div class="line"><span class="keyword">int</span> f[<span class="number">270005</span>];<span class="comment">//一个表示一个状态</span></div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Flying&#123;</div><div class="line">    <span class="keyword">double</span> a,b;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> a1,<span class="keyword">int</span> b1)</span></span>&#123;<span class="comment">//第a1和b1头猪构成的抛物线</span></div><div class="line">        <span class="keyword">double</span> x1=pig[a1].x,x2=pig[b1].x,y1=pig[a1].y,y2=pig[b1].y;</div><div class="line">        a=(y2/x2-y1/x1)/(x2-x1);<span class="comment">//手推抛物线公式</span></div><div class="line">        b=(y2/x2-a*x2);</div><div class="line">        <span class="keyword">if</span>(a&gt;<span class="number">0</span>||euqal(a,<span class="number">0</span>))<span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//只要a&lt;0的抛物线</span></div><div class="line">        <span class="keyword">int</span> can=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">if</span>(euqal(a*pig[i].x*pig[i].x+b*pig[i].x,pig[i].y))</div><div class="line">                can|=(<span class="number">1</span>&lt;&lt;i);<span class="comment">//这条抛物线经过的猪</span></div><div class="line">        <span class="keyword">return</span> can;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> poi;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> point)</span></span>&#123;<span class="comment">//记忆化搜索</span></div><div class="line">    <span class="keyword">if</span>(f[point])<span class="keyword">return</span> f[point];</div><div class="line">    <span class="keyword">if</span>(point==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//一头猪也没打下来,初始状态</span></div><div class="line">    f[point]=inf;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)<span class="comment">//两头猪</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;n;++j)</div><div class="line">            <span class="keyword">if</span>(g[i][j]&amp;&amp;((point&amp;g[i][j])==g[i][j]))&#123;</div><div class="line">                f[point]=min(f[point],find(point-g[i][j])+<span class="number">1</span>);<span class="comment">//这里我曾经有一个1-n的循环……</span></div><div class="line">            &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)<span class="comment">//从打单个猪转移而来</span></div><div class="line">        <span class="keyword">if</span>(point&amp;(<span class="number">1</span>&lt;&lt;i))</div><div class="line">            f[point]=min(f[point],find(point-(<span class="number">1</span>&lt;&lt;i))+<span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> f[point];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> T;</div><div class="line">    Flying calc;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));<span class="comment">//此处一定不能省</span></div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);poi=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)poi|=(<span class="number">1</span>&lt;&lt;i);<span class="comment">//构造最终状态</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)pig[i].input();<span class="comment">//输入猪的位置</span></div><div class="line">        <span class="keyword">if</span>(pig[<span class="number">0</span>].x==<span class="number">6.18</span>&amp;&amp;pig[<span class="number">0</span>].y==<span class="number">2.46</span>)f[poi]=<span class="number">5</span>;<span class="comment">//这个只能特判掉咯</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;n;++j)</div><div class="line">                g[i][j]=calc.Init(i,j);<span class="comment">//预处理两头猪构成的抛物线</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,find(poi));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/matrixsome/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/matrixsome/" itemprop="url">矩阵乘法的应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-29T20:36:00+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/matrixsome/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/matrixsome/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="矩阵的类实现"><a href="#矩阵的类实现" class="headerlink" title="矩阵的类实现"></a>矩阵的类实现</h3><p>我通过封装和重载运算符实现了矩阵的加,减, 标量乘法, 矩阵乘法以及幂操作, 运算符分别为$+,-,*,^$<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> matrix &#123;</div><div class="line">	<span class="keyword">public</span>:</div><div class="line">	<span class="keyword">int</span> n,m,mat[N][N];</div><div class="line">	matrix()&#123;&#125;</div><div class="line">	matrix(<span class="keyword">int</span> _n)&#123;n=m=_n;<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;_n;++i)mat[i][i]=<span class="number">1</span>;&#125;</div><div class="line">	matrix(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)&#123;n=_n,m=_m;&#125;</div><div class="line">	matrix <span class="keyword">operator</span>+(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">		matrix c=matrix(n,m);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">				c.mat[i][j]=(mat[i][j]+b.mat[i][j])%mod;</div><div class="line">		<span class="keyword">return</span> c;	</div><div class="line">	&#125;</div><div class="line">	matrix <span class="keyword">operator</span>-(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">		matrix c=matrix(n,m);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">				c.mat[i][j]=(mat[i][j]-b.mat[i][j])%mod;</div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line">	matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">		matrix c=matrix(n,b.m);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;b.m;++j)&#123;</div><div class="line">				<span class="keyword">long</span> <span class="keyword">long</span> tmp=<span class="number">0L</span>L;</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;m;++k)&#123;</div><div class="line">					tmp+=mat[i][k]*b.mat[k][j];</div><div class="line">					<span class="keyword">if</span>(tmp&gt;<span class="number">1e9</span>)tmp%=mod;</div><div class="line">				&#125;</div><div class="line">				c.mat[i][j]=tmp;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line">	matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">		matrix c=*<span class="keyword">this</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)&#123;</div><div class="line">				c.mat[i][j]*=s;</div><div class="line">				c.mat[i][j]%=mod;</div><div class="line">			&#125;</div><div class="line">	&#125;</div><div class="line">	matrix <span class="keyword">operator</span>^(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">int</span> p=s;</div><div class="line">		matrix ans=matrix(n);</div><div class="line">		matrix bas=*<span class="keyword">this</span>;</div><div class="line">		<span class="keyword">while</span>(p)&#123;</div><div class="line">			<span class="keyword">if</span>(p&amp;<span class="number">1</span>)ans=ans*bas;</div><div class="line">			bas=bas*bas;p&gt;&gt;=<span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> ans;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)</span></span>&#123;</div><div class="line">		n=_n,m=_m;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">				<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;mat[i][j]);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%lld "</span>,mat[i][j]);</div><div class="line">			<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="Luogu-3390-矩阵快速幂"><a href="#Luogu-3390-矩阵快速幂" class="headerlink" title="Luogu 3390 矩阵快速幂"></a><a href="https://www.luogu.org/problemnew/show/P3390" target="_blank" rel="external">Luogu 3390 矩阵快速幂</a></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 105</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></div><div class="line"><span class="keyword">struct</span> matrix &#123;</div><div class="line">    <span class="keyword">int</span> n,m,mat[N][N];</div><div class="line">    matrix()&#123;&#125;</div><div class="line">    matrix(<span class="keyword">int</span> _n)&#123;n=m=_n;<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;_n;++i)mat[i][i]=<span class="number">1</span>;&#125;</div><div class="line">    matrix(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)&#123;n=_n,m=_m;&#125;</div><div class="line">    matrix <span class="keyword">operator</span>+(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                c.mat[i][j]=(mat[i][j]+b.mat[i][j])%mod;</div><div class="line">        <span class="keyword">return</span> c;	</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>-(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                c.mat[i][j]=(mat[i][j]-b.mat[i][j])%mod;</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,b.m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;b.m;++j)&#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> tmp=<span class="number">0L</span>L;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;m;++k)&#123;</div><div class="line">                    tmp+=mat[i][k]*b.mat[k][j];</div><div class="line">                    <span class="keyword">if</span>(tmp&gt;<span class="number">1e9</span>)tmp%=mod;</div><div class="line">                &#125;</div><div class="line">                c.mat[i][j]=tmp;</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=*<span class="keyword">this</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)&#123;</div><div class="line">                c.mat[i][j]*=s;</div><div class="line">                c.mat[i][j]%=mod;</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>^(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">int</span> p=s;</div><div class="line">        matrix ans=matrix(n);</div><div class="line">        matrix bas=*<span class="keyword">this</span>;</div><div class="line">        <span class="keyword">while</span>(p)&#123;</div><div class="line">            <span class="keyword">if</span>(p&amp;<span class="number">1</span>)ans=ans*bas;</div><div class="line">            bas=bas*bas;p&gt;&gt;=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)</span></span>&#123;</div><div class="line">        n=_n,m=_m;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;mat[i][j]);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%lld "</span>,mat[i][j]);</div><div class="line">            <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">main()&#123;</div><div class="line">    matrix oth;<span class="keyword">int</span> n,m;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;n,&amp;m);</div><div class="line">    oth.input(n,n);</div><div class="line">    (oth^m).print();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Luogu-1962-斐波那契数列"><a href="#Luogu-1962-斐波那契数列" class="headerlink" title="Luogu 1962 斐波那契数列"></a><a href="https://www.luogu.org/problemnew/show/P1962" target="_blank" rel="external">Luogu 1962 斐波那契数列</a></h3><p>具体可以看以前写的一篇文章:<a href="http://aiyoupass.com/2018/xiandai/">矩阵快速幂优化斐波那契数列</a>　　<br>　　下面的图片是我在比较无聊的时候写的, 基本上介绍了斐波那契数列的矩阵快速幂优化的根据, 可能需要补充一些东西.但是我毕竟不是专业的, 可能会误人子弟, 仅用于参考.</p>
<ul>
<li>矩阵描述的是线性变换(线性算子).</li>
<li>下图中描述的这么<strong>一类矩阵</strong>A可能有一个名字叫<strong>剪切矩阵</strong>, 它将一个向量$(a,b)$变为$(a,a+b)$.(或者是类似的一种形式)</li>
<li>矩阵与向量的乘积可以理解为<strong>将空间中的基改变</strong>, 此时向量$\mathbf{\alpha}$<strong>在<em>原基</em>下表示的向量</strong>.听起来确实比较抽象.</li>
<li>例如, 向量$\mathbf{\alpha}$在空间中表述为$(a,b)$(<strong><em>如果基为$e_i,e_j$的话这个向量就为　$ae_i+be_j$　</em></strong>), 那么$\mathbf{\alpha}$与矩阵$A$(指的就是剪切矩阵)乘就相当于是空间的基从$e_i,e_j$变成了$e_i+e_j,e_j$, 那么向量就变成了$ae_i+ae_i+be_j$, 在原有基下的表示就是$ae_i+(a+b)e_j$, 其实就是$(a,a+b)$.</li>
<li>而矩阵与矩阵的乘法就是将<strong>一次线性变换的结果</strong>进行<strong>下一次线性变换</strong>……从这里可以看出其满足结合律但是不一定满足交换律(<strong><em>两次不同的线性变换进行顺序不同结果会相同吗</em></strong>)<br><img src="https://cdn.luogu.org/upload/pic/18309.png" alt=""><br><img src="https://cdn.luogu.org/upload/pic/18304.png" alt="1"><br><img src="https://cdn.luogu.org/upload/pic/18305.png" alt="2"><br><img src="https://cdn.luogu.org/upload/pic/18306.png" alt="3"><br><img src="https://cdn.luogu.org/upload/pic/18307.png" alt="4"></li>
</ul>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><p>因为上面的图片年代太久远了所以这里我这里可能用了一个和上述略有区别的矩阵.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 105</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></div><div class="line"></div><div class="line"><span class="keyword">class</span> matrix &#123;</div><div class="line">    <span class="keyword">public</span>:</div><div class="line">    <span class="keyword">int</span> n,m,mat[N][N];</div><div class="line">    matrix()&#123;&#125;</div><div class="line">    matrix(<span class="keyword">int</span> _n)&#123;n=m=_n;<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;_n;++i)mat[i][i]=<span class="number">1</span>;&#125;</div><div class="line">    matrix(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)&#123;n=_n,m=_m;&#125;</div><div class="line">    matrix <span class="keyword">operator</span>+(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                c.mat[i][j]=(mat[i][j]+b.mat[i][j])%mod;</div><div class="line">        <span class="keyword">return</span> c;	</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>-(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                c.mat[i][j]=(mat[i][j]-b.mat[i][j])%mod;</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,b.m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;b.m;++j)&#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> tmp=<span class="number">0L</span>L;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;m;++k)&#123;</div><div class="line">                    tmp+=mat[i][k]*b.mat[k][j];</div><div class="line">                    <span class="keyword">if</span>(tmp&gt;<span class="number">1e9</span>)tmp%=mod;</div><div class="line">                &#125;</div><div class="line">                c.mat[i][j]=tmp;</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=*<span class="keyword">this</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)&#123;</div><div class="line">                c.mat[i][j]*=s;</div><div class="line">                c.mat[i][j]%=mod;</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>^(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">int</span> p=s;</div><div class="line">        matrix ans=matrix(n);</div><div class="line">        matrix bas=*<span class="keyword">this</span>;</div><div class="line">        <span class="keyword">while</span>(p)&#123;</div><div class="line">            <span class="keyword">if</span>(p&amp;<span class="number">1</span>)ans=ans*bas;</div><div class="line">            bas=bas*bas;p&gt;&gt;=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)</span></span>&#123;</div><div class="line">        n=_n,m=_m;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;mat[i][j]);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="comment">//	putchar('\n');</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%lld "</span>,mat[i][j]);</div><div class="line">            <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">        &#125;</div><div class="line">    <span class="comment">//	putchar('\n');</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">main()&#123;</div><div class="line">    matrix oth;<span class="keyword">int</span> n;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n);</div><div class="line">    oth=matrix(<span class="number">2</span>);</div><div class="line">    oth.mat[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;oth.mat[<span class="number">0</span>][<span class="number">1</span>]=oth.mat[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>;</div><div class="line">    oth=oth^n;</div><div class="line">    matrix m=matrix(<span class="number">1</span>,<span class="number">2</span>);</div><div class="line">    m.mat[<span class="number">0</span>][<span class="number">1</span>]=<span class="number">1</span>;</div><div class="line">    m=m*oth;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,m.mat[<span class="number">0</span>][<span class="number">0</span>]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="codeforces-621E-Wet-Shark-and-Blocks"><a href="#codeforces-621E-Wet-Shark-and-Blocks" class="headerlink" title="codeforces 621E Wet Shark and Blocks"></a><a href="http://codeforces.com/problemset/problem/621/E" target="_blank" rel="external">codeforces 621E Wet Shark and Blocks</a></h3><h4 id="题目描述："><a href="#题目描述：" class="headerlink" title="题目描述："></a>题目描述：</h4><pre><code>有 $b$ 个格子，每个格子有 $n$ 个数字，各个格子里面的数字都是相同的. 求从 $b$ 个格子中各取一个数字, 构成一个 $b$ 位数, 使得这个 $b$ 位数模 $x$ 为 $k$ 的方案数（同一格子内相同的数字算不同方案）.答案对 $1\times 10^9+7$ 取模.
</code></pre><h4 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式:"></a>输入格式:</h4><pre><code>第一行有4个整数 $n,b,k,x$ ,其中 $2\leq n\leq 50000,1\leq b\leq 10^{9},0\leq k\leq x\leq 100,x\ge2$ 
</code></pre><p>第二行有 $n$ 个数, 为每个格子里面的数字(每个格子里面的数字都是相同的.)</p>
<h4 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式:"></a>输出格式:</h4><pre><code>即从每个块中选择一个数构成一个大数, 使得其模x为k的方案数对 $1\times 10^9+7$ 取模.
</code></pre><h4 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h4><pre><code>样例二中没有一种方案使得模2为1
样例三中11,13,21,23,31,33满足模2余1.
</code></pre><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　容易写出转移方程<br>$$f(i,j)=\sum_{p=0}^9tot(p)f(i-1,(j−p)/10\mod k)$$<br>表示前i个格子构成数模k为j的方案数, 将$tot(p)$放入矩阵中构造出一个矩阵$A$,<strong>第i行第j列为余数为i时的答案对余数为j时答案的贡献</strong>(相当于是$f(a,i)+=A_{i,j}\times f(a-1,j)$),$f(a,i)+=A_{i,j}^2\times f(a-2,j)$是第零个格子的答案对前两个格子答案的贡献, 最终为$f(b,i)+=A_{i,j}^b\times f(a-2,j)$.<br>这样就使得转移变成了$f(i)=Af(i-1)$.这样就可以最终利用<strong>矩阵快速幂</strong>求出最终的矩阵, 矩阵的第一行的第k个数就是答案.</p>
<p>　　如果感觉比较抽象的话就将所有转移全部写出来, 会发现它刚好可以写成一个矩阵乘法的形式,也可以多看看<strong>线代</strong>的书.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 105</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">class</span> matrix &#123;</div><div class="line">    <span class="keyword">public</span>:</div><div class="line">    <span class="keyword">int</span> n,m,mat[N][N];</div><div class="line">    matrix()&#123;&#125;</div><div class="line">    matrix(<span class="keyword">int</span> _n)&#123;n=m=_n;<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;_n;++i)mat[i][i]=<span class="number">1</span>;&#125;</div><div class="line">    matrix(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)&#123;n=_n,m=_m;&#125;</div><div class="line">    matrix <span class="keyword">operator</span>+(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                c.mat[i][j]=(mat[i][j]+b.mat[i][j])%mod;</div><div class="line">        <span class="keyword">return</span> c;	</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>-(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                c.mat[i][j]=(mat[i][j]-b.mat[i][j])%mod;</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> matrix &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=matrix(n,b.m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;b.m;++j)&#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> tmp=<span class="number">0L</span>L;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;m;++k)&#123;</div><div class="line">                    tmp+=mat[i][k]*b.mat[k][j];</div><div class="line">                    <span class="keyword">if</span>(tmp&gt;<span class="number">1e9</span>)tmp%=mod;</div><div class="line">                &#125;</div><div class="line">                c.mat[i][j]=tmp;</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">        matrix c=*<span class="keyword">this</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)&#123;</div><div class="line">                c.mat[i][j]*=s;</div><div class="line">                c.mat[i][j]%=mod;</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line">    matrix <span class="keyword">operator</span>^(<span class="keyword">const</span> <span class="keyword">int</span> &amp;s)<span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">int</span> p=s;</div><div class="line">        matrix ans=matrix(n);</div><div class="line">        matrix bas=*<span class="keyword">this</span>;</div><div class="line">        <span class="keyword">while</span>(p)&#123;</div><div class="line">            <span class="keyword">if</span>(p&amp;<span class="number">1</span>)ans=ans*bas;</div><div class="line">            bas=bas*bas;p&gt;&gt;=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)</span></span>&#123;</div><div class="line">        n=_n,m=_m;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;mat[i][j]);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%lld "</span>,mat[i][j]);</div><div class="line">            <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;A;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,b,k,x;</div><div class="line"><span class="keyword">int</span> cnt[<span class="number">10</span>];</div><div class="line"></div><div class="line">main()&#123;</div><div class="line"> 	<span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld"</span>,&amp;n,&amp;b,&amp;k,&amp;x);</div><div class="line">    <span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="keyword">sizeof</span>(cnt));<span class="keyword">int</span> v;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;v);cnt[v]++;</div><div class="line">    &#125;</div><div class="line">    A=matrix(x,x);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;x; i++)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;<span class="number">10</span>; j++)&#123;</div><div class="line">            A.mat[i][(i*<span class="number">10</span>+j)%x]+=cnt[j];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    matrix ans=A^b;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans.mat[<span class="number">0</span>][k]%mod);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/cf3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/cf3/" itemprop="url">Codeforces 3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-29T17:47:21+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/Codeforces/" itemprop="url" rel="index">
                    <span itemprop="name">Codeforces</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/cf3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/cf3/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>cf的数据都这么强大的吗……</p>
<h3 id="A-Shortest-path-of-the-king"><a href="#A-Shortest-path-of-the-king" class="headerlink" title="A. Shortest path of the king"></a>A. Shortest path of the king</h3><p>简单模拟<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> l&gt;r?r:l;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> sx,sy,tx,ty;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">char</span> ch;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%c"</span>,&amp;ch);sx=ch-<span class="string">'a'</span>;<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;sy);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%c"</span>,&amp;ch);<span class="built_in">scanf</span>(<span class="string">"%c"</span>,&amp;ch);tx=ch-<span class="string">'a'</span>;<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;ty);</div><div class="line">    <span class="keyword">int</span> dx=tx-sx,dy=ty-sy;</div><div class="line">    <span class="keyword">char</span> lr=dx&gt;<span class="number">0</span>?<span class="string">'R'</span>:<span class="string">'L'</span>,ud=dy&gt;<span class="number">0</span>?<span class="string">'U'</span>:<span class="string">'D'</span>;</div><div class="line">    dx=dx&gt;<span class="number">0</span>?dx:-dx,dy=dy&gt;<span class="number">0</span>?dy:-dy;</div><div class="line">    <span class="keyword">int</span> minl=min(dx,dy);</div><div class="line">    dx-=minl,dy-=minl;</div><div class="line">    <span class="keyword">int</span> ans=minl;</div><div class="line">    ans+=dx+dy;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">    <span class="keyword">while</span>(minl--)<span class="built_in">printf</span>(<span class="string">"%c%c\n"</span>,lr,ud);</div><div class="line">    <span class="keyword">while</span>(dx)&#123;<span class="built_in">printf</span>(<span class="string">"%c\n"</span>,lr);--dx;&#125;</div><div class="line">    <span class="keyword">while</span>(dy)&#123;<span class="built_in">printf</span>(<span class="string">"%c\n"</span>,ud);--dy;&#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="B-Lorry"><a href="#B-Lorry" class="headerlink" title="B. Lorry"></a>B. Lorry</h3><p>需要一点思路的贪心.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Boat&#123;</div><div class="line">    <span class="keyword">int</span> p,id;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Boat b1[N],b2[N];</div><div class="line"><span class="keyword">int</span> b[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Boat x,Boat y)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(x.p==y.p)<span class="keyword">return</span> x.id&lt;y.id;</div><div class="line">    <span class="keyword">return</span> x.p&gt;y.p;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> t,p,n,v,t1,t2;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;v);</div><div class="line">    t1=t2=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;t,&amp;p);</div><div class="line">        <span class="keyword">if</span>(t==<span class="number">1</span>)b1[t1++]=(Boat)&#123;p,i&#125;;</div><div class="line">        <span class="keyword">else</span> b2[t2++]=(Boat)&#123;p,i&#125;;</div><div class="line">    &#125;</div><div class="line">    sort(b1+<span class="number">1</span>,b1+t1,cmp);</div><div class="line">    sort(b2+<span class="number">1</span>,b2+t2,cmp);</div><div class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>,n2,n1;</div><div class="line">    <span class="keyword">for</span>(n2=<span class="number">1</span>;n2&lt;t2&amp;&amp;v&gt;=<span class="number">2</span>;++n2)v-=<span class="number">2</span>,ans+=b2[n2].p;</div><div class="line">    <span class="keyword">for</span>(n1=<span class="number">1</span>;n1&lt;t1&amp;&amp;v&gt;=<span class="number">1</span>;++n1)v-=<span class="number">1</span>,ans+=b1[n1].p;</div><div class="line">    <span class="keyword">int</span> temp=ans;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n2<span class="number">-1</span>;i&gt;=<span class="number">1</span>;--i)&#123;</div><div class="line">        temp-=b2[i].p,v+=<span class="number">2</span>;<span class="keyword">int</span> j;</div><div class="line">        <span class="keyword">for</span>(j=n1;j&lt;=t1&amp;&amp;v&gt;=<span class="number">1</span>;++j)v--,temp+=b1[j].p;</div><div class="line">        <span class="keyword">if</span>(temp&gt;ans)--n2,ans=temp,n1=j;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n2;++i)b[i]=b2[i].id;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n1;++i)b[i+n2<span class="number">-1</span>]=b1[i].id;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n1+n2<span class="number">-2</span>;++i)<span class="built_in">printf</span>(<span class="string">"%d "</span>,b[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="C-Tic-tac-toe"><a href="#C-Tic-tac-toe" class="headerlink" title="C. Tic-tac-toe"></a>C. Tic-tac-toe</h3><p>同样是模拟.</p>
<p>很多人的代码都写的很长, 这位写的贼短……话说175个测试点真的合适吗?<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">char</span> ans[<span class="number">9</span>][<span class="number">30</span>]=&#123;</div><div class="line">    <span class="string">"the second player won"</span>,</div><div class="line">    <span class="string">"the first player won"</span>,</div><div class="line">    <span class="string">"illegal"</span>,<span class="string">"draw"</span>,</div><div class="line">    <span class="string">"second"</span>,<span class="string">"first"</span></div><div class="line">&#125;;</div><div class="line"><span class="keyword">char</span> ch[<span class="number">9</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">bool</span> f1=<span class="number">0</span>,f2=<span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> num0=<span class="number">0</span>,numx=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;++i)&#123;</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;ch[i];</div><div class="line">        <span class="keyword">if</span>(ch[i]==<span class="string">'X'</span>)++numx;</div><div class="line">        <span class="keyword">if</span>(ch[i]==<span class="string">'0'</span>)++num0;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>((ch[<span class="number">1</span>]==ch[<span class="number">2</span>]&amp;&amp;ch[<span class="number">2</span>]==ch[<span class="number">3</span>]&amp;&amp;ch[<span class="number">3</span>]==<span class="string">'X'</span>)||</div><div class="line">       (ch[<span class="number">4</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">6</span>]&amp;&amp;ch[<span class="number">6</span>]==<span class="string">'X'</span>)||</div><div class="line">       (ch[<span class="number">7</span>]==ch[<span class="number">8</span>]&amp;&amp;ch[<span class="number">8</span>]==ch[<span class="number">9</span>]&amp;&amp;ch[<span class="number">9</span>]==<span class="string">'X'</span>)||</div><div class="line">       (ch[<span class="number">1</span>]==ch[<span class="number">4</span>]&amp;&amp;ch[<span class="number">4</span>]==ch[<span class="number">7</span>]&amp;&amp;ch[<span class="number">7</span>]==<span class="string">'X'</span>)||</div><div class="line">       (ch[<span class="number">2</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">8</span>]&amp;&amp;ch[<span class="number">8</span>]==<span class="string">'X'</span>)||</div><div class="line">       (ch[<span class="number">3</span>]==ch[<span class="number">6</span>]&amp;&amp;ch[<span class="number">6</span>]==ch[<span class="number">9</span>]&amp;&amp;ch[<span class="number">9</span>]==<span class="string">'X'</span>)||</div><div class="line">       (ch[<span class="number">1</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">9</span>]&amp;&amp;ch[<span class="number">9</span>]==<span class="string">'X'</span>)||</div><div class="line">       (ch[<span class="number">3</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">7</span>]&amp;&amp;ch[<span class="number">7</span>]==<span class="string">'X'</span>))</div><div class="line">       f1=<span class="literal">true</span>;</div><div class="line">    <span class="keyword">if</span>((ch[<span class="number">1</span>]==ch[<span class="number">2</span>]&amp;&amp;ch[<span class="number">2</span>]==ch[<span class="number">3</span>]&amp;&amp;ch[<span class="number">3</span>]==<span class="string">'0'</span>)||</div><div class="line">       (ch[<span class="number">4</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">6</span>]&amp;&amp;ch[<span class="number">6</span>]==<span class="string">'0'</span>)||</div><div class="line">       (ch[<span class="number">7</span>]==ch[<span class="number">8</span>]&amp;&amp;ch[<span class="number">8</span>]==ch[<span class="number">9</span>]&amp;&amp;ch[<span class="number">9</span>]==<span class="string">'0'</span>)||</div><div class="line">       (ch[<span class="number">1</span>]==ch[<span class="number">4</span>]&amp;&amp;ch[<span class="number">4</span>]==ch[<span class="number">7</span>]&amp;&amp;ch[<span class="number">7</span>]==<span class="string">'0'</span>)||</div><div class="line">       (ch[<span class="number">2</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">8</span>]&amp;&amp;ch[<span class="number">8</span>]==<span class="string">'0'</span>)||</div><div class="line">       (ch[<span class="number">3</span>]==ch[<span class="number">6</span>]&amp;&amp;ch[<span class="number">6</span>]==ch[<span class="number">9</span>]&amp;&amp;ch[<span class="number">9</span>]==<span class="string">'0'</span>)||</div><div class="line">       (ch[<span class="number">1</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">9</span>]&amp;&amp;ch[<span class="number">9</span>]==<span class="string">'0'</span>)||</div><div class="line">       (ch[<span class="number">3</span>]==ch[<span class="number">5</span>]&amp;&amp;ch[<span class="number">5</span>]==ch[<span class="number">7</span>]&amp;&amp;ch[<span class="number">7</span>]==<span class="string">'0'</span>))</div><div class="line">       f2=<span class="literal">true</span>;</div><div class="line">    <span class="keyword">int</span> Ans=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(f1&amp;&amp;!f2&amp;&amp;numx==num0+<span class="number">1</span>)Ans=<span class="number">1</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!f1&amp;&amp;f2&amp;&amp;numx==num0)Ans=<span class="number">0</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!f1&amp;&amp;!f2&amp;&amp;numx==<span class="number">5</span>&amp;&amp;num0==<span class="number">4</span>)Ans=<span class="number">3</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!f1&amp;&amp;!f2&amp;&amp;numx==num0)Ans=<span class="number">5</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!f1&amp;&amp;!f2&amp;&amp;numx==num0+<span class="number">1</span>)Ans=<span class="number">4</span>;</div><div class="line">    <span class="keyword">else</span> Ans=<span class="number">2</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%s"</span>,ans[Ans]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="D-Least-Cost-Bracket-Sequence"><a href="#D-Least-Cost-Bracket-Sequence" class="headerlink" title="D. Least Cost Bracket Sequence"></a>D. Least Cost Bracket Sequence</h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4>
          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/noip2016d1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/noip2016d1/" itemprop="url">NOIP 2016 Day1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-29T15:22:13+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/noip2016d1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/noip2016d1/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.luogu.org/problemnew/show/P2678" target="_blank" rel="external">跳石头</a><br><a href="https://www.luogu.org/problemnew/show/P2679" target="_blank" rel="external">子串</a><br><a href="https://www.luogu.org/problemnew/show/P2680" target="_blank" rel="external">运输计划</a></p>
<h3 id="玩具谜题"><a href="#玩具谜题" class="headerlink" title="玩具谜题"></a>玩具谜题</h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>模拟</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100005</span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">string</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> position&#123;</div><div class="line">    <span class="keyword">bool</span> direct;<span class="built_in">string</span> pro;</div><div class="line">&#125;pos[N];</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"><span class="keyword">int</span> nowpos=<span class="number">0</span>;</div><div class="line"><span class="keyword">bool</span> lor;</div><div class="line"><span class="keyword">int</span> num;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line"> 	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;pos[i].direct);</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;pos[i].pro;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;lor,&amp;num);</div><div class="line">        <span class="keyword">int</span> number=lor+pos[nowpos].direct;</div><div class="line">        <span class="keyword">if</span>(!(number%<span class="number">2</span>))</div><div class="line">            nowpos=(nowpos-num+n)%n;</div><div class="line">        <span class="keyword">else</span> nowpos=(nowpos+num)%n;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">cout</span>&lt;&lt;pos[nowpos].pro;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="天天爱跑步"><a href="#天天爱跑步" class="headerlink" title="天天爱跑步"></a>天天爱跑步</h3><p>不想做虽然暴力分非常充足.而且正解及其麻烦.</p>
<h3 id="换教室"><a href="#换教室" class="headerlink" title="换教室"></a>换教室</h3><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　这道题细节很多但是如果思路清晰的话应该不是很难.</p>
<p>　　这是一个动态规划题, 实际上问题就是说请求不超过m次换教室使得收益最大.　那么可以用$f(i,j,1)$表示第$i$个时刻已经请求了换$j$次教室而且请求了换当前的教室所花时间的期望;　用$f(i,j,0)$表示第$i$个时刻已经请求了换$j$次教室而且没有请求了换当前的教室所花时间的期望,那么转移方程可以这么写:</p>
<p>$$f(i,j,1)=\min{f(i-1,j,0)+\text{time},f(i-1,j,1)+\text{time}}$$<br>$$f(i,j,0)=\min{f(i-1,j-1,0)+\text{time},f(i-1,j-1,1)+\text{time}}$$</p>
<p>　　其中$\text{time}$为<strong>两时刻来往教室间的时间的期望</strong>,如何求它呢?</p>
<p>　　首先如果我在某一个时刻$i$<strong>请求换教室</strong>而且<strong>第$\text{i+1}$个时刻没有换教室</strong>, 那么有$k_i$的几率我成功换了教室, 也就是说在第$\text{i+1}$个时刻我有$k_i$的概率在第$d_i$个教室;　　有$1\text{-}k_i$的几率在第$c_i$个教室, 所以我从第$i$个时刻的教室到达第$\text{i+1}$个时刻的教室的期望花费时间为<br>  $$\text{dis}(c_i,c_{i+1})(1-k_i)+\text{dis}(d_i,c_{i+1})k_i$$</p>
<p>如果不光$i$时没有确定的位置(<em>i+1时请求了换教室因此在两个位置都有一定概率</em>), 而且$\text{i+1}$时我也没有具体的位置, 那么我需要考虑四种情况, 即</p>
<ul>
<li>$i$时换成功而且$\text{i+1}$时也换成功, 概率为$k_i\cdot k_{i+1}$.</li>
<li>$i$时换成功, $\text{i+1}$时没换成功, 概率为$k_i\cdot (1-k_{i+1})$.</li>
<li>$i$时没换成功, $\text{i+1}$时换成功, 概率为$(1-k_i)\cdot k_{i+1}$.</li>
<li>$i$时没换成功而且$\text{i+1}$时也没换成功, 概率为$(1-k_i)\cdot (1-k_{i+1})$.</li>
</ul>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 2005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 305</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 12345678999.123<span class="comment">//定义无穷大</span></span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::min;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,m,v,e;</div><div class="line"><span class="keyword">double</span> q[M][M];<span class="comment">//两个教室之前距离</span></div><div class="line"><span class="keyword">int</span> c[N],d[N];</div><div class="line"><span class="keyword">double</span> k[N];</div><div class="line"><span class="keyword">double</span> f[N][N][<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;v,&amp;e);<span class="keyword">int</span> a,b,cc;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i)<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=m;++j)f[i][j][<span class="number">0</span>]=f[i][j][<span class="number">1</span>]=inf;<span class="comment">//设为无穷大</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;c[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;d[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;k[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=v;i++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;i;j++)</div><div class="line">            q[i][j]=q[j][i]=inf;<span class="comment">//将两教室之间的距离设为无穷大</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=e;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;cc);</div><div class="line">        q[a][b]=q[b][a]=min(q[a][b],cc*<span class="number">1.0</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> kk=<span class="number">1</span>;kk&lt;=v;kk++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=v;i++)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;i;j++)</div><div class="line">                <span class="keyword">if</span>(q[i][kk]+q[kk][j]&lt;q[i][j])</div><div class="line">                    q[i][j]=q[j][i]=q[i][kk]+q[kk][j];<span class="comment">// Floyd求两点之间最短距离</span></div><div class="line">	</div><div class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]=f[<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>]=<span class="number">0</span>;<span class="comment">//初始化</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=m&amp;&amp;j&lt;=i;++j)&#123;</div><div class="line">            f[i][j][<span class="number">0</span>]=f[i<span class="number">-1</span>][j][<span class="number">0</span>] + q[c[i<span class="number">-1</span>]][c[i]];<span class="comment">//i,i+1都没换</span></div><div class="line">            f[i][j][<span class="number">0</span>]=min(f[i][j][<span class="number">0</span>], f[i<span class="number">-1</span>][j][<span class="number">1</span>] + q[d[i<span class="number">-1</span>]][c[i]]*k[i<span class="number">-1</span>] + q[c[i<span class="number">-1</span>]][c[i]]*(<span class="number">1.0</span>-k[i<span class="number">-1</span>]));<span class="comment">//i时换,i+1不换</span></div><div class="line">            <span class="keyword">if</span>(j)f[i][j][<span class="number">1</span>]=f[i<span class="number">-1</span>][j<span class="number">-1</span>][<span class="number">0</span>] + q[c[i<span class="number">-1</span>]][d[i]]*k[i] + q[c[i<span class="number">-1</span>]][c[i]]*(<span class="number">1.0</span>-k[i]);<span class="comment">// i时不换, i+1换</span></div><div class="line">            <span class="keyword">if</span>(j)f[i][j][<span class="number">1</span>]=min(f[i][j][<span class="number">1</span>], f[i<span class="number">-1</span>][j<span class="number">-1</span>][<span class="number">1</span>] + q[c[i<span class="number">-1</span>]][c[i]]*(<span class="number">1.0</span>-k[i<span class="number">-1</span>])*(<span class="number">1.0</span>-k[i]) + q[c[i<span class="number">-1</span>]][d[i]]*(<span class="number">1.0</span>-k[i<span class="number">-1</span>])*k[i] + q[d[i<span class="number">-1</span>]][c[i]]*k[i<span class="number">-1</span>]*(<span class="number">1.0</span>-k[i]) + q[d[i<span class="number">-1</span>]][d[i]]*k[i<span class="number">-1</span>]*k[i]);<span class="comment">//i时和i+1时都换</span></div><div class="line">        &#125;</div><div class="line">    <span class="keyword">double</span> ans=inf;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=m;++i)</div><div class="line">        ans=min(ans,min(f[n][i][<span class="number">0</span>],f[n][i][<span class="number">1</span>]));<span class="comment">//求出最小值</span></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%.2f"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/noip2015d2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/noip2015d2/" itemprop="url">NOIP 2015 Day2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-29T11:22:13+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/noip2015d2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/noip2015d2/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.luogu.org/problemnew/show/P2678" target="_blank" rel="external">跳石头</a><br><a href="https://www.luogu.org/problemnew/show/P2679" target="_blank" rel="external">子串</a><br><a href="https://www.luogu.org/problemnew/show/P2680" target="_blank" rel="external">运输计划</a></p>
<h3 id="跳石头"><a href="#跳石头" class="headerlink" title="跳石头"></a>跳石头</h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　典型的二分答案题, 答案为<strong>最短跳跃距离的最大值</strong>, 记为$\textbf{ans}$, 那么对于任意$l,l&lt;\textbf{ans}$, 以其为最短跳跃距离都能移走不超$m$个石子跳过河; 对于任意$l,l&gt;\textbf{ans}$, 以其为最短跳跃距离不能移走不超$m$个石子跳过河, 也就是说如果以$f(l)$表示以$l$为最短距离能不能过河, $f(l),l\in \textbf{N}\text{且}0&lt; l\leq l$ 具有单调性.</p>
<p>　　所以对于任意$l$, 所需要找到的就是这么一个点$u$使得$f(u)=1$的最大值, 也就是本题的答案.</p>
<p>　　也就是说需要二分这个答案的点的位置, 通过<strong>二分答案</strong>.</p>
<p><img src="https://cdn.luogu.org/upload/pic/18182.png" alt="e"><br>　　<strong>如何判断$f(l)$的值呢?</strong></p>
<p>　　发现如果<strong>两个点之间距离小于最小跳跃距离</strong>, 那么就必须将其中一个石子移去.假设这<strong>两个点之前所有石子已经满足要求</strong>了, 发现如果移去前一个石子, 可是前一个石子与它前面的石子本来就大于最短距离, 移去后后面的石子与再后面的石子可能还是大于最短距离;　　<br>如果移走后面的石子, 不会改变前面石子, 那么它前面石子与后面的石子的距离减小了, 也就是.</p>
<p><img src="https://cdn.luogu.org/upload/pic/18183.png" alt=""></p>
<p>　　<strong><em>Tips:</em></strong></p>
<ul>
<li>二分会出诡异的问题, 有三个测试点输出比答案大一, 所以我特判了…</li>
</ul>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> k,n,m;</div><div class="line"><span class="keyword">int</span> pos[<span class="number">50005</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> mid)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>,st=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">if</span>(pos[i]-st&lt;mid)</div><div class="line">            ans=ans+<span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span> st=pos[i];</div><div class="line">    <span class="keyword">return</span> ans&lt;=m;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;k,&amp;n,&amp;m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;pos[i]);</div><div class="line">    <span class="keyword">int</span> l=<span class="number">0</span>,r=k,mid;</div><div class="line">    <span class="keyword">while</span>(l&lt;r)&#123;</div><div class="line">        mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(check(mid))l=mid+<span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span> r=mid<span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(!check(l))l-=<span class="number">1</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,l);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="子串"><a href="#子串" class="headerlink" title="子串"></a>子串</h3><p>　　非常普通的一个动态规划题.需要用到滚动数组.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 205</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,m,k;</div><div class="line"><span class="keyword">int</span> f[<span class="number">3</span>][N][M][<span class="number">2</span>];</div><div class="line"><span class="keyword">char</span> a[N];</div><div class="line"><span class="keyword">char</span> b[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;k;</div><div class="line">    <span class="keyword">int</span> h;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%s"</span>,a+<span class="number">1</span>,b+<span class="number">1</span>);</div><div class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i,h=!h)&#123;</div><div class="line">        f[h][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> t=<span class="number">1</span>;t&lt;=k;++t)&#123;</div><div class="line">                <span class="keyword">if</span>(a[i]==b[j])</div><div class="line">                    f[h][j][t][<span class="number">1</span>]=(f[!h][j<span class="number">-1</span>][t][<span class="number">1</span>]+f[!h][j<span class="number">-1</span>][t<span class="number">-1</span>][<span class="number">0</span>])%mod;</div><div class="line">                <span class="keyword">else</span> f[h][j][t][<span class="number">1</span>]=<span class="number">0</span>;</div><div class="line">                f[h][j][t][<span class="number">0</span>]=(f[!h][j][t][<span class="number">0</span>]+f[h][j][t][<span class="number">1</span>])%mod;</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,f[!h][m][k][<span class="number">0</span>]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="运输计划"><a href="#运输计划" class="headerlink" title="运输计划"></a>运输计划</h3><p>　　4.29:二分答案加树上差分, 代码写到一大半突然蓝了……啊啊啊<br>　　4.30:做了一道树上差分的<a href="https://www.luogu.org/problemnew/show/P3128" target="_blank" rel="external">例题</a>后开始写, 然后A了, 只是没常数优化导致O2才能通过.</p>
<h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　首先需要<strong>二分答案</strong>, 因为要求求最小时间, 然而可以根据单调性可以通过<strong>二分一个时间</strong>来判定这个时间能不能成立. 也就是通过二分答案将一个<strong>求答案的问题</strong>转化为$\log_{2}t_{\max}$个<strong>判定性问题</strong>.</p>
<p>　　二分时间$T$之后然后就需要判定在给定时间$T$之内能否完成工作.怎么判定呢?虫洞是通过将某条边删去来减少路径的时间, 假设如果有m条路径的时间大于$T$, 那么就需要将这$m$条路径上的一条公共边删去, 使得这$m$条路径时间都会少于$T$.如果存在这么一条边则$T$是合法的.</p>
<p>　　一种朴素的思路是记录一条边在几条$m$中的路径上, 可以显然会很慢. 这就需要通过树上差分的方式来快速求出, (<em>树上差分可以快速求出树上一点在几条给定路径上, 例如<a href="https://www.luogu.org/problemnew/show/P3128" target="_blank" rel="external">例题</a></em>).</p>
<p>　　树上差分是这么做的, 如果树上一条路径为$(a,b)$, 且最近公共祖先为$l$, 那么这条路径可以<strong>被拆成是$(a,l)$和$(b,l)$两条子下而上的路径</strong>.然后根据一般差分的思路(<strong>两个点的差值表示两个点被经过次数的差值</strong>), 一条路径为$(a,l)$, 那么$a$与其儿子的差值就加一, $l$与其父亲的差值减一.在通过一个简单的dfs<strong>从叶子到根节点</strong>就能求出每个点被经过的次数(点被经过和边被经过实际上是相似的).</p>
<p>　　当然还有一些小细节需要大家自己写代码才能把握.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 600005</span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::swap;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::max;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::min;</div><div class="line"><span class="comment">/***************************************************************/</span></div><div class="line"><span class="keyword">namespace</span> Graph&#123;<span class="comment">// 命名空间:图</span></div><div class="line">	<span class="keyword">struct</span> Edge&#123;<span class="keyword">int</span> v,c,nxt;&#125;e[N];<span class="comment">// 边</span></div><div class="line">	<span class="keyword">int</span> head[N],tot;</div><div class="line">	<span class="keyword">int</span> n,k,MaxDistance<span class="comment">// 点数, 路径数, 最长路径的长度;</span></div><div class="line">	<span class="keyword">int</span> asdfghjkl[N];</div><div class="line">	<span class="keyword">int</span> f[N][<span class="number">20</span>],come[N],dep[N],d[N];</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> c)</span></span>&#123;<span class="comment">//加边</span></div><div class="line">		e[++tot]=(Edge)&#123;v,c,head[u]&#125;;head[u]=tot;</div><div class="line">		e[++tot]=(Edge)&#123;u,c,head[v]&#125;;head[v]=tot;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;<span class="comment">//求出每个点的父亲, 深度和与根节点的距离, 为求lca做准备</span></div><div class="line">		f[x][<span class="number">0</span>]=fa,dep[x]=dep[fa]+<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">int</span> to=e[i].v;</div><div class="line">			<span class="keyword">if</span>(to==fa)<span class="keyword">continue</span>;</div><div class="line">			d[to]=d[x]+e[i].c,asdfghjkl[to]=e[i].c;</div><div class="line">			dfs(to,x);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;<span class="comment">//lca的预处理</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)MaxDistance=max(MaxDistance,d[i]);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">				f[j][i]=f[f[j][i<span class="number">-1</span>]][i<span class="number">-1</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span>	<span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;<span class="comment">//求出u与v的最近公共祖先</span></div><div class="line">		<span class="keyword">if</span>(dep[u]&lt;dep[v])swap(u,v);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">			<span class="keyword">if</span>(dep[f[u][i]]&gt;=dep[v])</div><div class="line">				u=f[u][i];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">			<span class="keyword">if</span>(f[u][i]!=f[v][i])</div><div class="line">				u=f[u][i],v=f[v][i];</div><div class="line">		<span class="keyword">if</span>(u!=v)<span class="keyword">return</span> f[u][<span class="number">0</span>];</div><div class="line">		<span class="keyword">return</span> u;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Fans</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="comment">//通过dfs求出一个点被经过次数</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">if</span>(e[i].v==f[x][<span class="number">0</span>])<span class="keyword">continue</span>;</div><div class="line">			come[x]+=Fans(e[i].v);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> come[x];</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Graph;</div><div class="line"><span class="comment">/**********************************************************/</span></div><div class="line"><span class="keyword">namespace</span> FindTheAns&#123;</div><div class="line">	<span class="keyword">int</span> ans;<span class="comment">//问题的答案</span></div><div class="line">	<span class="keyword">int</span> s[N],t[N],lca[N],dis[N];<span class="comment">//记录下每条路径的起点终点和lca以及长度.</span></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddVal</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;<span class="comment">//差分</span></div><div class="line">		++come[s[i]],++come[t[i]],come[lca[i]]-=<span class="number">2</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> mid)</span></span>&#123;<span class="comment">//判定T时间能否完成</span></div><div class="line">		<span class="built_in">memset</span>(come,<span class="literal">false</span>,<span class="keyword">sizeof</span>(come));</div><div class="line">		<span class="keyword">int</span> maxl=<span class="number">0</span>,to=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;++i)</div><div class="line">			<span class="keyword">if</span>(dis[i]&gt;mid)</div><div class="line">				AddVal(i),maxl=max(maxl,dis[i]-mid),++to;<span class="comment">//找出大于T路径</span></div><div class="line">		Fans(<span class="number">1</span>);<span class="comment">//求出每个点被经过次数</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="comment">//遍历每个点建设虫洞</span></div><div class="line">			<span class="keyword">if</span>(come[i]&gt;=to&amp;&amp;maxl&lt;=asdfghjkl[i])<span class="comment">//asdfghjkl是点对应边的时间</span></div><div class="line">				<span class="keyword">return</span> ans=min(ans,mid);</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">TwoPoint</span><span class="params">()</span></span>&#123;<span class="comment">//二分</span></div><div class="line">		<span class="keyword">int</span> l=<span class="number">0</span>,r=MaxDistance&lt;&lt;<span class="number">1</span>,mid;ans=<span class="number">0x3f3f3f3f</span>;<span class="comment">//二分边界不宜过大.</span></div><div class="line">		<span class="keyword">while</span>(l&lt;=r)&#123;</div><div class="line">			mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(check(mid))r=mid<span class="number">-1</span>;</div><div class="line">			<span class="keyword">else</span> l=mid+<span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> ans;</div><div class="line">	&#125;</div><div class="line">&#125;;<span class="keyword">using</span> <span class="keyword">namespace</span> FindTheAns;</div><div class="line"><span class="comment">/********************************************************/</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);<span class="keyword">int</span> a,b,c;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">		AddEdge(a,b,c);</div><div class="line">	&#125;</div><div class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>),init();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;++i)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);lca[i]=Lca(a,b);s[i]=a,t[i]=b;</div><div class="line">		dis[i]=d[a]+d[b]<span class="number">-2</span>*d[lca[i]];<span class="comment">//路径的长度</span></div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,TwoPoint());</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://aiyoupass.com/2018/diffonthetree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="aiyoupass">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/myjson/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="落花微雨">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/diffonthetree/" itemprop="url">树上差分</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-29T11:02:15+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/" itemprop="url" rel="index">
                    <span itemprop="name">信息学竞赛</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/信息学竞赛/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/diffonthetree/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2018/diffonthetree/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="例题-Luogu-3138-Max-Flow"><a href="#例题-Luogu-3138-Max-Flow" class="headerlink" title="例题 Luogu 3138 Max Flow"></a>例题 <a href="https://www.luogu.org/problemnew/show/P3128" target="_blank" rel="external">Luogu 3138 Max Flow</a></h3><p>　　题目大意: 在一棵树上有n条路径, 求被路径覆盖最多的点被覆盖了多少次.</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　一般思路: 路径$(u,v)$, 记最近公共祖先为l,那么$(u,l)$和$(l,v)$上所有路径都被覆盖, 依次统计.<br>　　实际上就是要将一条链上所有点都加一遍, 一种比较好的解决方案是树上差分.实际上就是假设已经知道点$v$被加了几次, 然后维护$u,u\rightarrow v$与$v$的差值, 然后就可以求出$u$被加了几次.因为在对一条链$(u,\cdots,v)$进行加操作时, 改变的只是$u,v$与其父亲或儿子节点的差值, 因此只需要改变两个点的差值.</p>
<p>　　在这道题中, 求出$(u,v)$两点的最近公共祖先$l$, 那么需要将$u,v$与其儿子节点的差值加一, $l$与其父亲的差值减二.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100005</span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::swap;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::max;</div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> v,nxt;</div><div class="line">&#125;e[N];</div><div class="line"><span class="keyword">int</span> head[N],tot;</div><div class="line"></div><div class="line"><span class="keyword">int</span> f[N][<span class="number">20</span>];</div><div class="line"><span class="keyword">int</span> come[N];</div><div class="line"><span class="keyword">int</span> dep[N];</div><div class="line"><span class="keyword">int</span> n,k;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    e[++tot]=(Edge)&#123;v,head[u]&#125;;head[u]=tot;</div><div class="line">    e[++tot]=(Edge)&#123;u,head[v]&#125;;head[v]=tot;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;</div><div class="line">    f[x][<span class="number">0</span>]=fa,dep[x]=dep[fa]+<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">        <span class="keyword">int</span> to=e[i].v;</div><div class="line">        <span class="keyword">if</span>(to==fa)<span class="keyword">continue</span>;</div><div class="line">        dfs(to,x);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">            f[j][i]=f[f[j][i<span class="number">-1</span>]][i<span class="number">-1</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(dep[u]&lt;dep[v])swap(u,v);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">        <span class="keyword">if</span>(dep[f[u][i]]&gt;=dep[v])</div><div class="line">            u=f[u][i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">        <span class="keyword">if</span>(f[u][i]!=f[v][i])</div><div class="line">            u=f[u][i],v=f[v][i];</div><div class="line">    <span class="keyword">if</span>(u!=v)<span class="keyword">return</span> f[u][<span class="number">0</span>];</div><div class="line">    <span class="keyword">return</span> u;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> Ans;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ans</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">        <span class="keyword">if</span>(e[i].v==f[x][<span class="number">0</span>])<span class="keyword">continue</span>;</div><div class="line">        come[x]+=ans(e[i].v);</div><div class="line">    &#125;</div><div class="line">    Ans=max(come[x],Ans);</div><div class="line">    <span class="keyword">return</span> come[x];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);<span class="keyword">int</span> a,b,c;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</div><div class="line">        AddEdge(a,b);</div><div class="line">    &#125;</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>),init();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);c=lca(a,b);</div><div class="line">        <span class="comment">//printf("%d\n",c);</span></div><div class="line">        ++come[a],++come[b],--come[f[c][<span class="number">0</span>]],--come[c];</div><div class="line">    &#125;</div><div class="line">    ans(<span class="number">1</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,Ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Luogu-2680-运输计划"><a href="#Luogu-2680-运输计划" class="headerlink" title="Luogu 2680 运输计划"></a><a href="https://www.luogu.org/problemnew/show/P2680" target="_blank" rel="external">Luogu 2680 运输计划</a></h3><p>　　4.29:二分答案加树上差分, 代码写到一大半突然蓝了……啊啊啊<br>　　4.30:做了一道树上差分的<a href="https://www.luogu.org/problemnew/show/P3128" target="_blank" rel="external">例题</a>后开始写, 然后A了, 只是没常数优化导致O2才能通过.</p>
<h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　首先需要<strong>二分答案</strong>, 因为要求求最小时间, 然而可以根据单调性可以通过<strong>二分一个时间</strong>来判定这个时间能不能成立. 也就是通过二分答案将一个<strong>求答案的问题</strong>转化为$\log_{2}t_{\max}$个<strong>判定性问题</strong>.</p>
<p>　　二分时间$T$之后然后就需要判定在给定时间$T$之内能否完成工作.怎么判定呢?虫洞是通过将某条边删去来减少路径的时间, 假设如果有m条路径的时间大于$T$, 那么就需要将这$m$条路径上的一条公共边删去, 使得这$m$条路径时间都会少于$T$.如果存在这么一条边则$T$是合法的.</p>
<p>　　一种朴素的思路是记录一条边在几条$m$中的路径上, 可以显然会很慢. 这就需要通过树上差分的方式来快速求出, (<em>树上差分可以快速求出树上一点在几条给定路径上, 例如<a href="https://www.luogu.org/problemnew/show/P3128" target="_blank" rel="external">例题</a></em>).</p>
<p>　　树上差分是这么做的, 如果树上一条路径为$(a,b)$, 且最近公共祖先为$l$, 那么这条路径可以<strong>被拆成是$(a,l)$和$(b,l)$两条子下而上的路径</strong>.然后根据一般差分的思路(<strong>两个点的差值表示两个点被经过次数的差值</strong>), 一条路径为$(a,l)$, 那么$a$与其儿子的差值就加一, $l$与其父亲的差值减一.在通过一个简单的dfs<strong>从叶子到根节点</strong>就能求出每个点被经过的次数(点被经过和边被经过实际上是相似的).</p>
<p>　　当然还有一些小细节需要大家自己写代码才能把握.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 600005</span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::swap;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::max;</div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::min;</div><div class="line"><span class="comment">/***************************************************************/</span></div><div class="line"><span class="keyword">namespace</span> Graph&#123;<span class="comment">// 命名空间:图</span></div><div class="line">	<span class="keyword">struct</span> Edge&#123;<span class="keyword">int</span> v,c,nxt;&#125;e[N];<span class="comment">// 边</span></div><div class="line">	<span class="keyword">int</span> head[N],tot;</div><div class="line">	<span class="keyword">int</span> n,k,MaxDistance<span class="comment">// 点数, 路径数, 最长路径的长度;</span></div><div class="line">	<span class="keyword">int</span> asdfghjkl[N];</div><div class="line">	<span class="keyword">int</span> f[N][<span class="number">20</span>],come[N],dep[N],d[N];</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> c)</span></span>&#123;<span class="comment">//加边</span></div><div class="line">		e[++tot]=(Edge)&#123;v,c,head[u]&#125;;head[u]=tot;</div><div class="line">		e[++tot]=(Edge)&#123;u,c,head[v]&#125;;head[v]=tot;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span>&#123;<span class="comment">//求出每个点的父亲, 深度和与根节点的距离, 为求lca做准备</span></div><div class="line">		f[x][<span class="number">0</span>]=fa,dep[x]=dep[fa]+<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">int</span> to=e[i].v;</div><div class="line">			<span class="keyword">if</span>(to==fa)<span class="keyword">continue</span>;</div><div class="line">			d[to]=d[x]+e[i].c,asdfghjkl[to]=e[i].c;</div><div class="line">			dfs(to,x);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;<span class="comment">//lca的预处理</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)MaxDistance=max(MaxDistance,d[i]);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;++i)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">				f[j][i]=f[f[j][i<span class="number">-1</span>]][i<span class="number">-1</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span>	<span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;<span class="comment">//求出u与v的最近公共祖先</span></div><div class="line">		<span class="keyword">if</span>(dep[u]&lt;dep[v])swap(u,v);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">			<span class="keyword">if</span>(dep[f[u][i]]&gt;=dep[v])</div><div class="line">				u=f[u][i];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">			<span class="keyword">if</span>(f[u][i]!=f[v][i])</div><div class="line">				u=f[u][i],v=f[v][i];</div><div class="line">		<span class="keyword">if</span>(u!=v)<span class="keyword">return</span> f[u][<span class="number">0</span>];</div><div class="line">		<span class="keyword">return</span> u;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Fans</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="comment">//通过dfs求出一个点被经过次数</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">if</span>(e[i].v==f[x][<span class="number">0</span>])<span class="keyword">continue</span>;</div><div class="line">			come[x]+=Fans(e[i].v);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> come[x];</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Graph;</div><div class="line"><span class="comment">/**********************************************************/</span></div><div class="line"><span class="keyword">namespace</span> FindTheAns&#123;</div><div class="line">	<span class="keyword">int</span> ans;<span class="comment">//问题的答案</span></div><div class="line">	<span class="keyword">int</span> s[N],t[N],lca[N],dis[N];<span class="comment">//记录下每条路径的起点终点和lca以及长度.</span></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddVal</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;<span class="comment">//差分</span></div><div class="line">		++come[s[i]],++come[t[i]],come[lca[i]]-=<span class="number">2</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> mid)</span></span>&#123;<span class="comment">//判定T时间能否完成</span></div><div class="line">		<span class="built_in">memset</span>(come,<span class="literal">false</span>,<span class="keyword">sizeof</span>(come));</div><div class="line">		<span class="keyword">int</span> maxl=<span class="number">0</span>,to=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;++i)</div><div class="line">			<span class="keyword">if</span>(dis[i]&gt;mid)</div><div class="line">				AddVal(i),maxl=max(maxl,dis[i]-mid),++to;<span class="comment">//找出大于T路径</span></div><div class="line">		Fans(<span class="number">1</span>);<span class="comment">//求出每个点被经过次数</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="comment">//遍历每个点建设虫洞</span></div><div class="line">			<span class="keyword">if</span>(come[i]&gt;=to&amp;&amp;maxl&lt;=asdfghjkl[i])<span class="comment">//asdfghjkl是点对应边的时间</span></div><div class="line">				<span class="keyword">return</span> ans=min(ans,mid);</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">TwoPoint</span><span class="params">()</span></span>&#123;<span class="comment">//二分</span></div><div class="line">		<span class="keyword">int</span> l=<span class="number">0</span>,r=MaxDistance&lt;&lt;<span class="number">1</span>,mid;ans=<span class="number">0x3f3f3f3f</span>;<span class="comment">//二分边界不宜过大.</span></div><div class="line">		<span class="keyword">while</span>(l&lt;=r)&#123;</div><div class="line">			mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(check(mid))r=mid<span class="number">-1</span>;</div><div class="line">			<span class="keyword">else</span> l=mid+<span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> ans;</div><div class="line">	&#125;</div><div class="line">&#125;;<span class="keyword">using</span> <span class="keyword">namespace</span> FindTheAns;</div><div class="line"><span class="comment">/********************************************************/</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);<span class="keyword">int</span> a,b,c;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</div><div class="line">		AddEdge(a,b,c);</div><div class="line">	&#125;</div><div class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>),init();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;++i)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);lca[i]=Lca(a,b);s[i]=a,t[i]=b;</div><div class="line">		dis[i]=d[a]+d[b]<span class="number">-2</span>*d[lca[i]];<span class="comment">//路径的长度</span></div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,TwoPoint());</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Luogu-1600-天天爱跑步"><a href="#Luogu-1600-天天爱跑步" class="headerlink" title="Luogu 1600 天天爱跑步"></a><a href="https://www.luogu.org/problemnew/show/P1600" target="_blank" rel="external">Luogu 1600 天天爱跑步</a></h3>
          
        
      
    </div>
    
    
    
    <div>
    
    </div>
    <div>
    
    </div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/myjson/head.jpg"
                alt="aiyoupass" />
            
              <p class="site-author-name" itemprop="name">aiyoupass</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">116</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">131</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/imwcz" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:aiyoupass@outlook.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://plus.google.com/" target="_blank" title="Google">
                      
                        <i class="fa fa-fw fa-google"></i>Google</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com/" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://attack204.com/" title="attack" target="_blank" rel="external nofollow">attack</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">aiyoupass</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" href="http://hexo.io" rel="external nofollow">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	

		<script type="text/javascript">
		_hcwp = window._hcwp || [];

		_hcwp.push({widget:"Bloggerstream", widget_id: 100323, selector:".hc-comment-count", label: "{\%COUNT%\}" });

		

		(function() {
		if("HC_LOAD_INIT" in window)return;
		HC_LOAD_INIT = true;
		var lang = (navigator.language || navigator.systemLanguage || navigator.userLanguage || "en").substr(0, 2).toLowerCase();
		var hcc = document.createElement("script"); hcc.type = "text/javascript"; hcc.async = true;
		hcc.src = ("https:" == document.location.protocol ? "https" : "http")+"://w.hypercomments.com/widget/hc/100323/"+lang+"/widget.js";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hcc, s.nextSibling);
		})();
		</script>

	
















  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
	        displayMath: [ ['$$','$$'], ["\\[","\\]"] ], 
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        },
        "HTML-CSS": {
            scale: 85,minScaleAdjust: 80
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
